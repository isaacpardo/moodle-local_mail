import{n as I,s as gl,g as pl,a as bl,b as Os,c as lt,i as hl,S as le,d as ne,e as te,f as vl,h as z,j as v,t as B,k as d,l as k,m as g,o as K,p as be,q as he,r as ze,u as q,v as kl,w as wl,x as yl,y as S,z as Te,A as He,B as D,C as w,D as _e,E as We,F as Ks,G as Xe,H as ge,I as ce,J as x,K as ee,L as G,M as H,N as O,O as ae,P as Be,Q as Ie,R as F,T as qe,U as Ue,V as Re,W as ie,X as Ge,Y as we,Z as Ze,_ as Ye,$ as ve,a0 as ke,a1 as Ml,a2 as $l,a3 as xe,a4 as $e,a5 as Vs,a6 as Oe,a7 as Ws,a8 as Xs,a9 as Ys,aa as Js,ab as nt,ac as Sl,ad as Ne,ae as je,af as Pe,ag as Cl,ah as Tl,ai as Qs,aj as zl,ak as Ll}from"./global-b937fbcc.js";const Ae=[];function Dl(l,e=I){let t;const s=new Set;function r(a){if(gl(l,a)&&(l=a,t)){const o=!Ae.length;for(const f of s)f[1](),Ae.push(f,l);if(o){for(let f=0;f<Ae.length;f+=2)Ae[f][0](Ae[f+1]);Ae.length=0}}}function n(a){r(a(l))}function i(a,o=I){const f=[a,o];return s.add(f),s.size===1&&(t=e(r)||I),a(l),()=>{s.delete(f),s.size===0&&t&&(t(),t=null)}}return{set:r,update:n,subscribe:i}}let Je={};async function Al(l){return Je[l]==null&&(Je[l]=await new Promise(e=>{window.require([l],e)})),Je[l]}var Ce=(l=>(l[l.NotDeleted=0]="NotDeleted",l[l.Deleted=1]="Deleted",l[l.DeletedForever=2]="DeletedForever",l))(Ce||{});async function Zs(l){let e=await Al("core/ajax");return await Promise.all(e.call(Array.from(l).map(({methodname:s,...r})=>({methodname:`local_mail_${s}`,args:r}))))}const Ke=["","blue","indigo","purple","pink","red","orange","yellow","green","teal","cyan"];function rt(l){if(l==0)return"";const e=new Date(l*1e3);return[String(e.getFullYear()),String(e.getMonth()+1).padStart(2,"0"),String(e.getDate()).padStart(2,"0")].join("-")}function it(l){const e=[{bytes:1099511627776,name:"TB"},{bytes:1073741824,name:"GB"},{bytes:1048576,name:"MB"},{bytes:1024,name:"KB"}];for(let t of e)if(l>=t.bytes)return`${Intl.NumberFormat(void 0,{maximumFractionDigits:1}).format(l/t.bytes)} ${t.name}`;return`${l} B`}function at(l){return l.trim().replaceAll(/\s+/gu," ")}function Me(l,e){if(l=l||"",typeof e=="string"||typeof e=="number")l=l.replace("{$a}",e.toString());else for(const t in e)l=l.replace(`{$a->${t}}`,e[t].toString());return l}async function Nl(l){return new Promise(e=>{setTimeout(e,l)})}function jl(l){return l?Math.floor(new Date(parseInt(l.slice(0,4)),parseInt(l.slice(5,7))-1,parseInt(l.slice(8,10)),23,59,59).getTime()/1e3):0}var fe=(l=>(l[l.SM=576]="SM",l[l.MD=768]="MD",l[l.LG=992]="LG",l[l.XL=1200]="XL",l))(fe||{});async function Bl(l){let e=0;const{subscribe:t,update:s}=Dl({userid:l.userid,settings:l.settings,preferences:l.preferences,strings:l.strings,params:{tray:"inbox"},unread:0,drafts:0,courses:[],labels:[],totalCount:0,listMessages:[],loading:!0,selectedMessages:new Map,toasts:[],navigationId:0,viewSize:0}),r={subscribe:t,get(){return pl(this)},async callServicesAndRefresh(n,i,a=!1){var L,N,P,W;const o=++e;let f=i||r.get().params;const c=r.get().preferences.perpage;s(j=>({...j,loading:!0})),n.push({methodname:"count_messages",query:{roles:["to","cc","bcc"],unread:!0}}),n.push({methodname:"count_messages",query:{draft:!0}}),n.push({methodname:"get_courses"}),n.push({methodname:"get_labels"});const m={courseid:f.courseid,labelid:f.tray=="label"?f.labelid:void 0,draft:f.tray=="drafts"?!0:f.tray=="sent"?!1:void 0,roles:f.tray=="inbox"?["to","cc","bcc"]:f.tray=="sent"?["from"]:void 0,starred:f.tray=="starred"?!0:void 0,deleted:f.tray=="trash"};n.push({methodname:"count_messages",query:m}),f.messageid?(n.push({methodname:"get_message",messageid:f.messageid}),n.push({methodname:"search_messages",query:{...m,...f.search,startid:f.messageid,reverse:!1},limit:1}),n.push({methodname:"search_messages",query:{...m,...f.search,startid:f.messageid,reverse:!0},limit:1}),f.search||n.push({methodname:"count_messages",query:{...m,startid:f.messageid,reverse:!0}})):n.push({methodname:"search_messages",query:{...m,...f.search},offset:f.search?void 0:f.offset,limit:f.search?c+1:c});let u;try{u=await Zs(n)}catch(j){return r.setError(j),[]}let _,b,p,h,y=[];f.messageid?(f.search||(b=u.pop()),h=(L=u.pop()[0])==null?void 0:L.id,p=(N=u.pop()[0])==null?void 0:N.id,_=u.pop()):(y=u.pop(),f.search&&(f.search.reverse?(h=(P=y[c])==null?void 0:P.id,p=f.search.startid,y=y.slice(0,c).reverse()):(h=f.search.startid,p=(W=y[c])==null?void 0:W.id,y=y.slice(0,c))));let C=u.pop(),A=u.pop(),M=u.pop(),$=u.pop(),T=u.pop();return f.tray=="course"&&!M.find(j=>j.id==f.courseid)||f.tray=="label"&&!A.find(j=>j.id==f.labelid)?(await r.navigate({tray:"inbox"},!0),u):(o!=e||(s(j=>({...j,params:f,unread:T,drafts:$,courses:M,labels:A,messageOffset:b,totalCount:C,listMessages:y,message:_,nextMessageId:p,prevMessageId:h,selectedMessages:new Map(_?[[_.id,_]]:j.message?[]:y.filter(J=>j.selectedMessages.has(J.id)).map(J=>[J.id,J])),loading:!1})),bl(f,a)),u)},async createLabel(n,i){const a={methodname:"create_label",name:n,color:i};return(await r.callServicesAndRefresh([a])).pop()},async deleteLabel(n){const i={methodname:"delete_label",labelid:n};r.callServicesAndRefresh([i],{tray:"inbox"})},async emptyTrash(){const n={methodname:"empty_trash"};await r.callServicesAndRefresh([n])},hideToast(n){s(i=>({...i,toasts:i.toasts.filter(a=>a!=n)}))},async init(){const n=[];this.get().settings.incrementalsearch&&n.push({methodname:"search_messages",query:{deleted:!1},offset:r.get().settings.incrementalsearchlimit,limit:1});const i=await r.callServicesAndRefresh(n,Os());s(a=>{var o,f;return{...a,incrementalSearchStopId:(f=(o=i.pop())==null?void 0:o[0])==null?void 0:f.id}})},async navigate(n,i=!1){const a=[];n!=null&&n.messageid&&a.push({methodname:"set_unread",messageid:n.messageid,unread:!1}),await r.callServicesAndRefresh(a,n,i),s(o=>({...o,navigationId:o.navigationId+1}))},selectAll(n){s(i=>({...i,selectedMessages:new Map(i.listMessages.filter(a=>n=="all"||n=="read"&&!a.unread||n=="unread"&&a.unread||n=="starred"&&a.starred||n=="unstarred"&&!a.starred).map(a=>[a.id,a]))}))},async selectCourse(n){const i=this.get().params;await this.navigate({...i,courseid:n,offset:0,messageid:void 0,search:i.search?{...i.search,startid:void 0,reverse:void 0}:void 0})},async setDeleted(n,i,a){const o=n.map(c=>({methodname:"set_deleted",messageid:c,deleted:i}));let f={...r.get().params,messageid:void 0};if(await r.callServicesAndRefresh(o,f,!0),i!=Ce.DeletedForever){const c=i?n.length>1?"undodeletemany":"undodeleteone":n.length>1?"undorestoremany":"undorestoreone",m=Me(r.get().strings[c],n.length),u=()=>{r.setDeleted(n,i?Ce.NotDeleted:Ce.Deleted,!1)};r.showToast({text:m,undo:a?u:void 0})}},async setError(n){s(i=>({...i,loading:i.loading&&!n,error:n}))},async setLabels(n,i,a){const o=[];s(f=>({...f,messages:f.listMessages.map(c=>{if(n.includes(c.id)){const m=f.labels.filter(u=>i.includes(u.id)?!0:a.includes(u.id)?!1:c.labels.findIndex(_=>_.id==u.id)>=0);return o.push({methodname:"set_labels",messageid:c.id,labelids:m.map(u=>u.id)}),{...c,labels:m}}else return c})})),await r.callServicesAndRefresh(o)},setViewportSize(n){s(i=>({...i,viewSize:n,navigationId:i.navigationId+1}))},async setPerPage(n){s(a=>({...a,preferences:{...a.preferences,perpage:n}}));const i={methodname:"set_preferences",preferences:{perpage:n}};await r.callServicesAndRefresh([i]),s(a=>({...a,navigationId:a.navigationId+1}))},async setStarred(n,i){s(o=>({...o,messages:o.listMessages.map(f=>n.includes(f.id)?{...f,starred:i}:f)}));const a=n.map(o=>({methodname:"set_starred",messageid:o,starred:i}));await r.callServicesAndRefresh(a)},async setUnread(n,i){const a={...r.get().params,messageid:void 0};s(f=>({...f,messages:f.listMessages.map(c=>n.includes(c.id)?{...c,unread:i}:c)}));const o=n.map(f=>({methodname:"set_unread",messageid:f,unread:i}));await r.callServicesAndRefresh(o,a)},async showToast(n){s(i=>({...i,toasts:[n]})),n&&(await Nl(1e4),r.hideToast(n))},toggleSelected(n){s(i=>({...i,selectedMessages:new Map(i.listMessages.filter(a=>a.id==n?!i.selectedMessages.has(a.id):i.selectedMessages.has(a.id)).map(a=>[a.id,a]))}))},async undo(n){n.undo&&(await n.undo(),r.hideToast(n))},async updateLabel(n,i,a){const o={methodname:"update_label",labelid:n,name:i,color:a};await r.callServicesAndRefresh([o])}};return await r.init(),r}function xs(l){const e=l-1;return e*e*e+1}function Fe(l,{delay:e=0,duration:t=400,easing:s=hl}={}){const r=+getComputedStyle(l).opacity;return{delay:e,duration:t,easing:s,css:n=>`opacity: ${n*r}`}}function Ve(l,{delay:e=0,duration:t=400,easing:s=xs,x:r=0,y:n=0,opacity:i=0}={}){const a=getComputedStyle(l),o=+a.opacity,f=a.transform==="none"?"":a.transform,c=o*(1-i),[m,u]=lt(r),[_,b]=lt(n);return{delay:e,duration:t,easing:s,css:(p,h)=>`
			transform: ${f} translate(${(1-p)*m}${u}, ${(1-p)*_}${b});
			opacity: ${o-c*h}`}}const{document:Il}=Xe;function ot(l){let e,t,s=l[1]&&ft(l),r=l[2]&&l[4]&&ut(l);return{c(){e=v("div"),s&&s.c(),t=z(),r&&r.c(),d(e,"class","modal-footer")},m(n,i){k(n,e,i),s&&s.m(e,null),g(e,t),r&&r.m(e,null)},p(n,i){n[1]?s?s.p(n,i):(s=ft(n),s.c(),s.m(e,t)):s&&(s.d(1),s=null),n[2]&&n[4]?r?r.p(n,i):(r=ut(n),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},d(n){n&&w(e),s&&s.d(),r&&r.d()}}}function ft(l){let e,t,s,r;return{c(){e=v("button"),t=B(l[1]),d(e,"type","button"),d(e,"class","btn btn-secondary")},m(n,i){k(n,e,i),g(e,t),s||(r=K(e,"click",function(){be(l[3])&&l[3].apply(this,arguments)}),s=!0)},p(n,i){l=n,i&2&&q(t,l[1])},d(n){n&&w(e),s=!1,r()}}}function ut(l){let e,t,s,r,n;return{c(){e=v("button"),t=B(l[2]),d(e,"type","button"),d(e,"class",s="btn "+l[5]),e.disabled=l[6]},m(i,a){k(i,e,a),g(e,t),r||(n=K(e,"click",function(){be(l[4])&&l[4].apply(this,arguments)}),r=!0)},p(i,a){l=i,a&4&&q(t,l[2]),a&32&&s!==(s="btn "+l[5])&&d(e,"class",s),a&64&&(e.disabled=l[6])},d(i){i&&w(e),r=!1,n()}}}function ql(l){let e,t,s,r,n,i,a,o,f,c,m,u,_,b,p,h,y,C,A,M,$;const T=l[10].default,L=vl(T,l,l[9],null);let N=(l[1]||l[2]&&l[4])&&ot(l);return{c(){e=z(),t=v("div"),s=v("div"),r=v("div"),n=v("div"),i=v("h5"),a=B(l[0]),o=z(),f=v("button"),c=v("span"),c.textContent="×",m=z(),u=v("div"),L&&L.c(),_=z(),N&&N.c(),h=z(),y=v("div"),d(i,"class","modal-title"),d(c,"aria-hidden","true"),d(f,"type","button"),d(f,"class","close"),d(f,"aria-label",l[1]),d(n,"class","modal-header"),d(u,"class","modal-body"),d(r,"class","modal-content"),d(s,"class","modal-dialog"),d(t,"class","modal show"),d(t,"tabindex","-1"),d(t,"role","dialog"),d(t,"aria-label",l[0]),d(t,"aria-modal","true"),d(y,"class","modal-backdrop show")},m(P,W){k(P,e,W),k(P,t,W),g(t,s),g(s,r),g(r,n),g(n,i),g(i,a),g(n,o),g(n,f),g(f,c),g(r,m),g(r,u),L&&L.m(u,null),g(r,_),N&&N.m(r,null),l[11](t),k(P,h,W),k(P,y,W),A=!0,M||($=[K(Il.body,"keyup",l[8]),K(f,"click",function(){be(l[3])&&l[3].apply(this,arguments)}),he(b=ze.call(null,r,l[3])),K(t,"keyup",l[8])],M=!0)},p(P,[W]){l=P,(!A||W&1)&&q(a,l[0]),(!A||W&2)&&d(f,"aria-label",l[1]),L&&L.p&&(!A||W&512)&&kl(L,T,l,l[9],A?yl(T,l[9],W,null):wl(l[9]),null),l[1]||l[2]&&l[4]?N?N.p(l,W):(N=ot(l),N.c(),N.m(r,null)):N&&(N.d(1),N=null),b&&be(b.update)&&W&8&&b.update.call(null,l[3]),(!A||W&1)&&d(t,"aria-label",l[0])},i(P){A||(S(L,P),Te(()=>{A&&(p||(p=He(t,Ve,{y:-100},!0)),p.run(1))}),Te(()=>{A&&(C||(C=He(y,Fe,{},!0)),C.run(1))}),A=!0)},o(P){D(L,P),p||(p=He(t,Ve,{y:-100},!1)),p.run(0),C||(C=He(y,Fe,{},!1)),C.run(0),A=!1},d(P){P&&w(e),P&&w(t),L&&L.d(P),N&&N.d(),l[11](null),P&&p&&p.end(),P&&w(h),P&&w(y),P&&C&&C.end(),M=!1,_e($)}}}function Rl(l,e,t){let{$$slots:s={},$$scope:r}=e,{title:n}=e,{cancelText:i=""}=e,{confirmText:a=""}=e,{handleCancel:o}=e,{handleConfirm:f=void 0}=e,{confirmClass:c="btn-primary"}=e,{confirmDisabled:m=!1}=e,u;We(()=>{document.body.classList.add("modal-open"),u.focus()}),Ks(()=>{document.body.classList.remove("modal-open")});const _=p=>{p.key=="Escape"&&o()};function b(p){ge[p?"unshift":"push"](()=>{u=p,t(7,u)})}return l.$$set=p=>{"title"in p&&t(0,n=p.title),"cancelText"in p&&t(1,i=p.cancelText),"confirmText"in p&&t(2,a=p.confirmText),"handleCancel"in p&&t(3,o=p.handleCancel),"handleConfirm"in p&&t(4,f=p.handleConfirm),"confirmClass"in p&&t(5,c=p.confirmClass),"confirmDisabled"in p&&t(6,m=p.confirmDisabled),"$$scope"in p&&t(9,r=p.$$scope)},[n,i,a,o,f,c,m,u,_,r,s,b]}class Ee extends le{constructor(e){super(),ne(this,e,Rl,ql,te,{title:0,cancelText:1,confirmText:2,handleCancel:3,handleConfirm:4,confirmClass:5,confirmDisabled:6})}}function ct(l){let e,t;return e=new Ee({props:{title:l[1].strings.error,handleCancel:l[2],$$slots:{default:[El]},$$scope:{ctx:l}}}),{c(){G(e.$$.fragment)},m(s,r){H(e,s,r),t=!0},p(s,r){const n={};r&2&&(n.title=s[1].strings.error),r&1&&(n.handleCancel=s[2]),r&10&&(n.$$scope={dirty:r,ctx:s}),e.$set(n)},i(s){t||(S(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function mt(l){var r;let e,t=((r=l[1].error)==null?void 0:r.debuginfo)+"",s;return{c(){e=v("p"),s=B(t)},m(n,i){k(n,e,i),g(e,s)},p(n,i){var a;i&2&&t!==(t=((a=n[1].error)==null?void 0:a.debuginfo)+"")&&q(s,t)},d(n){n&&w(e)}}}function dt(l){var r;let e,t=((r=l[1].error)==null?void 0:r.stacktrace)+"",s;return{c(){e=v("pre"),s=B(t)},m(n,i){k(n,e,i),g(e,s)},p(n,i){var a;i&2&&t!==(t=((a=n[1].error)==null?void 0:a.stacktrace)+"")&&q(s,t)},d(n){n&&w(e)}}}function El(l){var f,c,m;let e,t=((f=l[1].error)==null?void 0:f.message)+"",s,r,n,i,a=((c=l[1].error)==null?void 0:c.debuginfo)&&mt(l),o=((m=l[1].error)==null?void 0:m.stacktrace)&&dt(l);return{c(){e=v("p"),s=B(t),r=z(),a&&a.c(),n=z(),o&&o.c(),i=ce()},m(u,_){k(u,e,_),g(e,s),k(u,r,_),a&&a.m(u,_),k(u,n,_),o&&o.m(u,_),k(u,i,_)},p(u,_){var b,p,h;_&2&&t!==(t=((b=u[1].error)==null?void 0:b.message)+"")&&q(s,t),(p=u[1].error)!=null&&p.debuginfo?a?a.p(u,_):(a=mt(u),a.c(),a.m(n.parentNode,n)):a&&(a.d(1),a=null),(h=u[1].error)!=null&&h.stacktrace?o?o.p(u,_):(o=dt(u),o.c(),o.m(i.parentNode,i)):o&&(o.d(1),o=null)},d(u){u&&w(e),u&&w(r),a&&a.d(u),u&&w(n),o&&o.d(u),u&&w(i)}}}function Pl(l){let e,t,s=l[1].error&&ct(l);return{c(){s&&s.c(),e=ce()},m(r,n){s&&s.m(r,n),k(r,e,n),t=!0},p(r,[n]){r[1].error?s?(s.p(r,n),n&2&&S(s,1)):(s=ct(r),s.c(),S(s,1),s.m(e.parentNode,e)):s&&(x(),D(s,1,1,()=>{s=null}),ee())},i(r){t||(S(s),t=!0)},o(r){D(s),t=!1},d(r){s&&s.d(r),r&&w(e)}}}function Fl(l,e,t){let s,r=I,n=()=>(r(),r=ae(i,o=>t(1,s=o)),i);l.$$.on_destroy.push(()=>r());let{store:i}=e;n();const a=()=>i.setError();return l.$$set=o=>{"store"in o&&n(t(0,i=o.store))},[i,s,a]}class Ul extends le{constructor(e){super(),ne(this,e,Fl,Pl,te,{store:0})}}function _t(l){let e,t,s,r,n,i,a,o=l[3]&&gt(l);return{c(){e=v("div"),t=v("button"),s=v("i"),n=z(),o&&o.c(),d(s,"class","fa fa-fw fa-ellipsis-v align-middle"),d(t,"type","button"),d(t,"class","btn"),d(t,"aria-expanded",l[3]),d(t,"title",r=l[5].strings.moreactions),d(e,"class","dropdown")},m(f,c){k(f,e,c),g(e,t),g(t,s),g(e,n),o&&o.m(e,null),i||(a=[K(t,"click",l[6]),he(ze.call(null,e,l[7]))],i=!0)},p(f,c){c&8&&d(t,"aria-expanded",f[3]),c&32&&r!==(r=f[5].strings.moreactions)&&d(t,"title",r),f[3]?o?o.p(f,c):(o=gt(f),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(f){f&&w(e),o&&o.d(),i=!1,_e(a)}}}function gt(l){let e,t,s,r,n=l[5].strings.reply+"",i,a,o,f,c,m,u=l[5].strings.replyall+"",_,b,p,h,y,C,A=l[5].strings.forward+"",M,$;return{c(){e=v("div"),t=v("a"),s=v("i"),r=z(),i=B(n),o=z(),f=v("a"),c=v("i"),m=z(),_=B(u),p=z(),h=v("a"),y=v("i"),C=z(),M=B(A),d(s,"class","fa fa-fw fa-reply"),d(s,"aria-hidden","true"),d(t,"type","button"),d(t,"class","dropdown-item"),d(t,"href",a=Be(l[1].id)+"}"),d(c,"class","fa fa-fw fa-reply-all"),d(c,"aria-hidden","true"),d(f,"type","button"),d(f,"class","dropdown-item"),d(f,"href",b=Ie(l[1].id)+"}"),F(f,"disabled",!l[2]),d(y,"class","fa fa-fw fa-share"),d(y,"aria-hidden","true"),d(h,"type","button"),d(h,"class","dropdown-item"),d(h,"href",$=qe(l[1].id)+"}"),d(e,"class","dropdown-menu dropdown-menu-right show")},m(T,L){k(T,e,L),g(e,t),g(t,s),g(t,r),g(t,i),g(e,o),g(e,f),g(f,c),g(f,m),g(f,_),g(e,p),g(e,h),g(h,y),g(h,C),g(h,M)},p(T,L){L&32&&n!==(n=T[5].strings.reply+"")&&q(i,n),L&2&&a!==(a=Be(T[1].id)+"}")&&d(t,"href",a),L&32&&u!==(u=T[5].strings.replyall+"")&&q(_,u),L&2&&b!==(b=Ie(T[1].id)+"}")&&d(f,"href",b),L&4&&F(f,"disabled",!T[2]),L&32&&A!==(A=T[5].strings.forward+"")&&q(M,A),L&2&&$!==($=qe(T[1].id)+"}")&&d(h,"href",$)},d(T){T&&w(e)}}}function pt(l){let e,t,s,r,n,i,a,o,f,c,m,u,_,b;return{c(){e=v("a"),t=v("i"),n=z(),i=v("a"),a=v("i"),c=z(),m=v("a"),u=v("i"),d(t,"class","fa fa-fw fa-reply"),d(t,"aria-hidden","true"),d(e,"href",s=Be(l[1].id)),d(e,"title",r=l[5].strings.reply),d(e,"class","btn py-2 border-0"),d(a,"class","fa fa-fw fa-reply-all"),d(a,"aria-hidden","true"),d(i,"href",o=Ie(l[1].id)),d(i,"title",f=l[5].strings.replyall),d(i,"class","btn py-2 border-0"),F(i,"disabled",!l[2]),d(u,"class","fa fa-fw fa-share"),d(u,"aria-hidden","true"),d(m,"href",_=qe(l[1].id)),d(m,"title",b=l[5].strings.forward),d(m,"class","btn py-2 border-0")},m(p,h){k(p,e,h),g(e,t),k(p,n,h),k(p,i,h),g(i,a),k(p,c,h),k(p,m,h),g(m,u)},p(p,h){h&2&&s!==(s=Be(p[1].id))&&d(e,"href",s),h&32&&r!==(r=p[5].strings.reply)&&d(e,"title",r),h&2&&o!==(o=Ie(p[1].id))&&d(i,"href",o),h&32&&f!==(f=p[5].strings.replyall)&&d(i,"title",f),h&4&&F(i,"disabled",!p[2]),h&2&&_!==(_=qe(p[1].id))&&d(m,"href",_),h&32&&b!==(b=p[5].strings.forward)&&d(m,"title",b)},d(p){p&&w(e),p&&w(n),p&&w(i),p&&w(c),p&&w(m)}}}function Gl(l){let e,t,s,r,n,i,a,o,f,c,m,u=l[5].viewSize<fe.SM&&_t(l),_=l[5].viewSize>=fe.SM&&pt(l);return{c(){e=v("button"),t=v("i"),a=z(),u&&u.c(),o=z(),_&&_.c(),f=ce(),d(t,"class",s="fa "+l[4]),d(e,"class","btn py-2 border-0"),d(e,"role","checkbox"),d(e,"aria-checked",r=l[1].starred),e.disabled=n=l[1].deleted,d(e,"title",i=l[1].starred?l[5].strings.markasunstarred:l[5].strings.markasstarred)},m(b,p){k(b,e,p),g(e,t),k(b,a,p),u&&u.m(b,p),k(b,o,p),_&&_.m(b,p),k(b,f,p),c||(m=K(e,"click",l[8]),c=!0)},p(b,[p]){p&16&&s!==(s="fa "+b[4])&&d(t,"class",s),p&2&&r!==(r=b[1].starred)&&d(e,"aria-checked",r),p&2&&n!==(n=b[1].deleted)&&(e.disabled=n),p&34&&i!==(i=b[1].starred?b[5].strings.markasunstarred:b[5].strings.markasstarred)&&d(e,"title",i),b[5].viewSize<fe.SM?u?u.p(b,p):(u=_t(b),u.c(),u.m(o.parentNode,o)):u&&(u.d(1),u=null),b[5].viewSize>=fe.SM?_?_.p(b,p):(_=pt(b),_.c(),_.m(f.parentNode,f)):_&&(_.d(1),_=null)},i:I,o:I,d(b){b&&w(e),b&&w(a),u&&u.d(b),b&&w(o),_&&_.d(b),b&&w(f),c=!1,m()}}}function Hl(l,e,t){let s,r,n=I,i=()=>(n(),n=ae(a,b=>t(5,r=b)),a);l.$$.on_destroy.push(()=>n());let{store:a}=e;i();let{message:o}=e,{canReplyAll:f}=e,c=!1;const m=()=>{t(3,c=!c)},u=()=>{t(3,c=!1)},_=()=>a.setStarred([o.id],!o.starred);return l.$$set=b=>{"store"in b&&i(t(0,a=b.store)),"message"in b&&t(1,o=b.message),"canReplyAll"in b&&t(2,f=b.canReplyAll)},l.$$.update=()=>{l.$$.dirty&2&&t(4,s=o.starred?"fa-star text-warning":"fa-star-o")},[a,o,f,c,s,r,m,u,_]}class Ol extends le{constructor(e){super(),ne(this,e,Hl,Gl,te,{store:0,message:1,canReplyAll:2})}}function bt(l,e,t){const s=l.slice();return s[1]=e[t],s}function ht(l){let e,t,s,r,n,i,a=(l[1].filepath+l[1].filename).replace(/^\//,"")+"",o,f,c,m,u=it(l[1].filesize)+"",_,b;return{c(){e=v("div"),t=v("img"),n=z(),i=v("a"),o=B(a),c=z(),m=v("span"),_=B(u),b=z(),d(t,"aria-hidden","true"),d(t,"alt",s=l[1].filename),Re(t.src,r=l[1].iconurl)||d(t,"src",r),d(t,"width","24"),d(t,"height","24"),d(t,"class","mr-2"),d(i,"href",f=l[1].fileurl),d(i,"class","mr-2"),d(m,"class","text-muted"),d(e,"class","mr-5 mb-3")},m(p,h){k(p,e,h),g(e,t),g(e,n),g(e,i),g(i,o),g(e,c),g(e,m),g(m,_),g(e,b)},p(p,h){h&1&&s!==(s=p[1].filename)&&d(t,"alt",s),h&1&&!Re(t.src,r=p[1].iconurl)&&d(t,"src",r),h&1&&a!==(a=(p[1].filepath+p[1].filename).replace(/^\//,"")+"")&&q(o,a),h&1&&f!==(f=p[1].fileurl)&&d(i,"href",f),h&1&&u!==(u=it(p[1].filesize)+"")&&q(_,u)},d(p){p&&w(e)}}}function Kl(l){let e,t=l[0].attachments,s=[];for(let r=0;r<t.length;r+=1)s[r]=ht(bt(l,t,r));return{c(){e=v("div");for(let r=0;r<s.length;r+=1)s[r].c();d(e,"class","d-sm-flex flex-sm-wrap mr-n5 mt-3 mb-n3")},m(r,n){k(r,e,n);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null)},p(r,[n]){if(n&1){t=r[0].attachments;let i;for(i=0;i<t.length;i+=1){const a=bt(r,t,i);s[i]?s[i].p(a,n):(s[i]=ht(a),s[i].c(),s[i].m(e,null))}for(;i<s.length;i+=1)s[i].d(1);s.length=t.length}},i:I,o:I,d(r){r&&w(e),Ue(s,r)}}}function Vl(l,e,t){let{message:s}=e;return l.$$set=r=>{"message"in r&&t(0,s=r.message)},[s]}class el extends le{constructor(e){super(),ne(this,e,Vl,Kl,te,{message:0})}}function Wl(l){let e,t,s,r=l[3].strings.reply+"",n,i,a,o,f,c,m=l[3].strings.replyall+"",u,_,b,p,h,y,C=l[3].strings.forward+"",A,M;return{c(){e=v("a"),t=v("i"),s=z(),n=B(r),a=z(),o=v("a"),f=v("i"),c=z(),u=B(m),b=z(),p=v("a"),h=v("i"),y=z(),A=B(C),d(t,"class","fa fa-fw fa-reply mr-2"),d(e,"href",i=Be(l[1].id)),d(e,"class","btn btn-primary mr-3 mb-3"),d(f,"class","fa fa-fw fa-reply-all mr-2"),d(o,"href",_=Ie(l[1].id)),d(o,"class","btn mr-3 mb-3"),F(o,"disabled",!l[2]),F(o,"btn-primary",l[2]),F(o,"btn-secondary",!l[2]),d(h,"class","fa fa-fw fa-share mr-2"),d(p,"href",M=qe(l[1].id)),d(p,"class","btn btn-primary mr-3 mb-3")},m($,T){k($,e,T),g(e,t),g(e,s),g(e,n),k($,a,T),k($,o,T),g(o,f),g(o,c),g(o,u),k($,b,T),k($,p,T),g(p,h),g(p,y),g(p,A)},p($,[T]){T&8&&r!==(r=$[3].strings.reply+"")&&q(n,r),T&2&&i!==(i=Be($[1].id))&&d(e,"href",i),T&8&&m!==(m=$[3].strings.replyall+"")&&q(u,m),T&2&&_!==(_=Ie($[1].id))&&d(o,"href",_),T&4&&F(o,"disabled",!$[2]),T&4&&F(o,"btn-primary",$[2]),T&4&&F(o,"btn-secondary",!$[2]),T&8&&C!==(C=$[3].strings.forward+"")&&q(A,C),T&2&&M!==(M=qe($[1].id))&&d(p,"href",M)},i:I,o:I,d($){$&&w(e),$&&w(a),$&&w(o),$&&w(b),$&&w(p)}}}function Xl(l,e,t){let s,r=I,n=()=>(r(),r=ae(i,f=>t(3,s=f)),i);l.$$.on_destroy.push(()=>r());let{store:i}=e;n();let{message:a}=e,{canReplyAll:o}=e;return l.$$set=f=>{"store"in f&&n(t(0,i=f.store)),"message"in f&&t(1,a=f.message),"canReplyAll"in f&&t(2,o=f.canReplyAll)},[i,a,o,s]}class Yl extends le{constructor(e){super(),ne(this,e,Xl,Wl,te,{store:0,message:1,canReplyAll:2})}}function vt(l){let e,t,s,r,n;return{c(){e=v("span"),t=B(l[2]),d(e,"class","local-mail-course-badge badge px-2 mr-2 mb-2 svelte-zl9zhm"),ie(e,"min-width","3rem"),ie(e,"max-width","calc("+l[1]+"ch + 1.5rem)")},m(i,a){k(i,e,a),g(e,t),r||(n=he(s=Ge.call(null,e,l[2])),r=!0)},p(i,a){a&4&&q(t,i[2]),a&2&&ie(e,"max-width","calc("+i[1]+"ch + 1.5rem)"),s&&be(s.update)&&a&4&&s.update.call(null,i[2])},d(i){i&&w(e),r=!1,n()}}}function Jl(l){let e=["shortname","fullname"].includes(l[0].coursebadges),t,s=e&&vt(l);return{c(){s&&s.c(),t=ce()},m(r,n){s&&s.m(r,n),k(r,t,n)},p(r,[n]){n&1&&(e=["shortname","fullname"].includes(r[0].coursebadges)),e?s?s.p(r,n):(s=vt(r),s.c(),s.m(t.parentNode,t)):s&&(s.d(1),s=null)},i:I,o:I,d(r){s&&s.d(r),r&&w(t)}}}function Ql(l,e,t){let s,r,{course:n}=e,{settings:i}=e;return l.$$set=a=>{"course"in a&&t(3,n=a.course),"settings"in a&&t(0,i=a.settings)},l.$$.update=()=>{l.$$.dirty&9&&t(2,s=i.coursebadges=="shortname"?n.shortname:n.fullname),l.$$.dirty&1&&t(1,r=i.coursebadgeslength||20)},[i,r,s,n]}class et extends le{constructor(e){super(),ne(this,e,Ql,Jl,te,{course:3,settings:0})}}function Zl(l){let e,t=l[0].name+"",s,r;return{c(){e=v("span"),s=B(t),d(e,"class","local-mail-label-badge badge flex-shrink-0 px-2 mr-2 mb-2 svelte-1xmrn49"),d(e,"style",r=`color: var(--local-mail-color-${l[1]}-fg, var(--local-mail-color-gray-fg));background-color: var(--local-mail-color-${l[1]}-bg, var(--local-mail-color-gray-bg))`)},m(n,i){k(n,e,i),g(e,s)},p(n,[i]){i&1&&t!==(t=n[0].name+"")&&q(s,t),i&2&&r!==(r=`color: var(--local-mail-color-${n[1]}-fg, var(--local-mail-color-gray-fg));background-color: var(--local-mail-color-${n[1]}-bg, var(--local-mail-color-gray-bg))`)&&d(e,"style",r)},i:I,o:I,d(n){n&&w(e)}}}function xl(l,e,t){let s,{label:r}=e;return l.$$set=n=>{"label"in n&&t(0,r=n.label)},l.$$.update=()=>{l.$$.dirty&1&&t(1,s=Ke.includes(r.color)?r.color:"gray")},[r,s]}class tl extends le{constructor(e){super(),ne(this,e,xl,Zl,te,{label:0})}}function kt(l,e,t){const s=l.slice();return s[3]=e[t],s}function wt(l){let e,t;return e=new et({props:{course:l[1].course,settings:l[2].settings}}),{c(){G(e.$$.fragment)},m(s,r){H(e,s,r),t=!0},p(s,r){const n={};r&2&&(n.course=s[1].course),r&4&&(n.settings=s[2].settings),e.$set(n)},i(s){t||(S(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function yt(l,e){let t,s,r;return s=new tl({props:{label:e[3]}}),{key:l,first:null,c(){t=ce(),G(s.$$.fragment),this.first=t},m(n,i){k(n,t,i),H(s,n,i),r=!0},p(n,i){e=n;const a={};i&2&&(a.label=e[3]),s.$set(a)},i(n){r||(S(s.$$.fragment,n),r=!0)},o(n){D(s.$$.fragment,n),r=!1},d(n){n&&w(t),O(s,n)}}}function en(l){let e,t=[],s=new Map,r,n,i=l[1].course.id!=l[2].params.courseid&&wt(l),a=l[1].labels;const o=f=>f[3].id;for(let f=0;f<a.length;f+=1){let c=kt(l,a,f),m=o(c);s.set(m,t[f]=yt(m,c))}return{c(){i&&i.c(),e=z();for(let f=0;f<t.length;f+=1)t[f].c();r=ce()},m(f,c){i&&i.m(f,c),k(f,e,c);for(let m=0;m<t.length;m+=1)t[m]&&t[m].m(f,c);k(f,r,c),n=!0},p(f,[c]){f[1].course.id!=f[2].params.courseid?i?(i.p(f,c),c&6&&S(i,1)):(i=wt(f),i.c(),S(i,1),i.m(e.parentNode,e)):i&&(x(),D(i,1,1,()=>{i=null}),ee()),c&2&&(a=f[1].labels,x(),t=we(t,c,o,1,f,a,s,r.parentNode,Ze,yt,r,kt),ee())},i(f){if(!n){S(i);for(let c=0;c<a.length;c+=1)S(t[c]);n=!0}},o(f){D(i);for(let c=0;c<t.length;c+=1)D(t[c]);n=!1},d(f){i&&i.d(f),f&&w(e);for(let c=0;c<t.length;c+=1)t[c].d(f);f&&w(r)}}}function tn(l,e,t){let s,r=I,n=()=>(r(),r=ae(i,o=>t(2,s=o)),i);l.$$.on_destroy.push(()=>r());let{store:i}=e;n();let{message:a}=e;return l.$$set=o=>{"store"in o&&n(t(0,i=o.store)),"message"in o&&t(1,a=o.message)},[i,a,s]}class sn extends le{constructor(e){super(),ne(this,e,tn,en,te,{store:0,message:1})}}function Mt(l){let e,t,s,r;return s=new el({props:{message:l[0]}}),{c(){e=v("hr"),t=z(),G(s.$$.fragment)},m(n,i){k(n,e,i),k(n,t,i),H(s,n,i),r=!0},p(n,i){const a={};i&1&&(a.message=n[0]),s.$set(a)},i(n){r||(S(s.$$.fragment,n),r=!0)},o(n){D(s.$$.fragment,n),r=!1},d(n){n&&w(e),n&&w(t),O(s,n)}}}function ln(l){let e,t,s,r=l[0].subject+"",n,i,a,o,f,c,m,u,_,b,p,h=l[0].sender.fullname+"",y,C,A,M,$=l[0].fulltime+"",T,L,N,P,W,j=l[0].content+"",J,se,R=l[0].attachments.length>0&&Mt(l);return{c(){e=v("div"),t=v("div"),s=v("h5"),n=B(r),i=z(),a=v("div"),o=v("div"),f=v("div"),c=v("img"),_=z(),b=v("div"),p=v("a"),y=B(h),A=z(),M=v("div"),T=B($),L=z(),N=v("hr"),P=z(),W=v("div"),J=z(),R&&R.c(),d(s,"class","h5 card-title mb-3"),d(c,"aria-hidden","true"),d(c,"alt",m=l[0].sender.fullname),Re(c.src,u=l[0].sender.pictureurl)||d(c,"src",u),d(c,"width","35"),d(c,"height","35"),d(c,"class","rounded-circle"),d(f,"class","mr-3"),d(p,"href",C=l[0].sender.profileurl),d(b,"class","mt-1"),d(o,"class","d-flex mb-3 mb-sm-0"),d(M,"class","mt-1 ml-auto"),d(a,"class","d-sm-flex mb-n1"),d(W,"class","local-mail-message-reference-content svelte-nahnfm"),d(t,"class","card-body p-3 px-xl-4"),d(e,"class","card mb-4")},m(Y,re){k(Y,e,re),g(e,t),g(t,s),g(s,n),g(t,i),g(t,a),g(a,o),g(o,f),g(f,c),g(o,_),g(o,b),g(b,p),g(p,y),g(a,A),g(a,M),g(M,T),g(t,L),g(t,N),g(t,P),g(t,W),W.innerHTML=j,g(t,J),R&&R.m(t,null),se=!0},p(Y,[re]){(!se||re&1)&&r!==(r=Y[0].subject+"")&&q(n,r),(!se||re&1&&m!==(m=Y[0].sender.fullname))&&d(c,"alt",m),(!se||re&1&&!Re(c.src,u=Y[0].sender.pictureurl))&&d(c,"src",u),(!se||re&1)&&h!==(h=Y[0].sender.fullname+"")&&q(y,h),(!se||re&1&&C!==(C=Y[0].sender.profileurl))&&d(p,"href",C),(!se||re&1)&&$!==($=Y[0].fulltime+"")&&q(T,$),(!se||re&1)&&j!==(j=Y[0].content+"")&&(W.innerHTML=j),Y[0].attachments.length>0?R?(R.p(Y,re),re&1&&S(R,1)):(R=Mt(Y),R.c(),S(R,1),R.m(t,null)):R&&(x(),D(R,1,1,()=>{R=null}),ee())},i(Y){se||(S(R),se=!0)},o(Y){D(R),se=!1},d(Y){Y&&w(e),R&&R.d()}}}function nn(l,e,t){let{reference:s}=e;return l.$$set=r=>{"reference"in r&&t(0,s=r.reference)},[s]}class rn extends le{constructor(e){super(),ne(this,e,nn,ln,te,{reference:0})}}function $t(l,e,t){const s=l.slice();return s[4]=e[t],s}function St(l,e,t){const s=l.slice();return s[7]=e[t],s[9]=t,s}function Ct(l){let e,t,s=l[3].strings[l[4]]+"",r,n,i,a=[],o=new Map,f,c=l[2](l[4]);const m=u=>u[7].id;for(let u=0;u<c.length;u+=1){let _=St(l,c,u),b=m(_);o.set(b,a[u]=zt(b,_))}return{c(){e=v("div"),t=v("span"),r=B(s),n=B(":"),i=z();for(let u=0;u<a.length;u+=1)a[u].c();f=z(),d(e,"class","mb-2")},m(u,_){k(u,e,_),g(e,t),g(t,r),g(t,n),g(e,i);for(let b=0;b<a.length;b+=1)a[b]&&a[b].m(e,null);g(e,f)},p(u,_){_&8&&s!==(s=u[3].strings[u[4]]+"")&&q(r,s),_&4&&(c=u[2](u[4]),a=we(a,_,m,1,u,c,o,e,Ye,zt,f,St))},d(u){u&&w(e);for(let _=0;_<a.length;_+=1)a[_].d()}}}function Tt(l){let e;return{c(){e=B(",")},m(t,s){k(t,e,s)},d(t){t&&w(e)}}}function zt(l,e){let t,s,r,n=e[7].fullname+"",i,a,o=e[9]>0&&Tt();return{key:l,first:null,c(){t=ce(),o&&o.c(),s=z(),r=v("a"),i=B(n),d(r,"href",a=e[7].profileurl),this.first=t},m(f,c){k(f,t,c),o&&o.m(f,c),k(f,s,c),k(f,r,c),g(r,i)},p(f,c){e=f,e[9]>0?o||(o=Tt(),o.c(),o.m(s.parentNode,s)):o&&(o.d(1),o=null),c&4&&n!==(n=e[7].fullname+"")&&q(i,n),c&4&&a!==(a=e[7].profileurl)&&d(r,"href",a)},d(f){f&&w(t),o&&o.d(f),f&&w(s),f&&w(r)}}}function Lt(l){let e=l[2](l[4]).length>0,t,s=e&&Ct(l);return{c(){s&&s.c(),t=ce()},m(r,n){s&&s.m(r,n),k(r,t,n)},p(r,n){n&4&&(e=r[2](r[4]).length>0),e?s?s.p(r,n):(s=Ct(r),s.c(),s.m(t.parentNode,t)):s&&(s.d(1),s=null)},d(r){s&&s.d(r),r&&w(t)}}}function an(l){let e,t,s,r,n,i,a,o,f,c=l[1].sender.fullname+"",m,u,_,b=["to","cc","bcc"],p=[];for(let h=0;h<3;h+=1)p[h]=Lt($t(l,b,h));return{c(){e=v("div"),t=v("div"),s=v("img"),i=z(),a=v("div"),o=v("div"),f=v("a"),m=B(c),_=z();for(let h=0;h<3;h+=1)p[h].c();d(s,"aria-hidden","true"),d(s,"alt",r=l[1].sender.fullname),Re(s.src,n=l[1].sender.pictureurl)||d(s,"src",n),d(s,"width","35"),d(s,"height","35"),d(s,"class","rounded-circle"),d(t,"class","mr-3"),d(f,"href",u=l[1].sender.profileurl),d(o,"class","mt-1 mb-2"),d(a,"class","d-flex flex-column"),d(e,"class","local-mail-message-users d-flex mb-n2")},m(h,y){k(h,e,y),g(e,t),g(t,s),g(e,i),g(e,a),g(a,o),g(o,f),g(f,m),g(a,_);for(let C=0;C<3;C+=1)p[C]&&p[C].m(a,null)},p(h,[y]){if(y&2&&r!==(r=h[1].sender.fullname)&&d(s,"alt",r),y&2&&!Re(s.src,n=h[1].sender.pictureurl)&&d(s,"src",n),y&2&&c!==(c=h[1].sender.fullname+"")&&q(m,c),y&2&&u!==(u=h[1].sender.profileurl)&&d(f,"href",u),y&12){b=["to","cc","bcc"];let C;for(C=0;C<3;C+=1){const A=$t(h,b,C);p[C]?p[C].p(A,y):(p[C]=Lt(A),p[C].c(),p[C].m(a,null))}for(;C<3;C+=1)p[C].d(1)}},i:I,o:I,d(h){h&&w(e),Ue(p,h)}}}function on(l,e,t){let s,r,n=I,i=()=>(n(),n=ae(a,f=>t(3,r=f)),a);l.$$.on_destroy.push(()=>n());let{store:a}=e;i();let{message:o}=e;return l.$$set=f=>{"store"in f&&i(t(0,a=f.store)),"message"in f&&t(1,o=f.message)},l.$$.update=()=>{l.$$.dirty&2&&t(2,s=f=>o.recipients.filter(c=>c.type==f))},[a,o,s,r]}class fn extends le{constructor(e){super(),ne(this,e,on,an,te,{store:0,message:1})}}function Dt(l,e,t){const s=l.slice();return s[4]=e[t],s}function At(l){let e,t,s,r;return s=new el({props:{message:l[1]}}),{c(){e=v("hr"),t=z(),G(s.$$.fragment)},m(n,i){k(n,e,i),k(n,t,i),H(s,n,i),r=!0},p(n,i){const a={};i&2&&(a.message=n[1]),s.$set(a)},i(n){r||(S(s.$$.fragment,n),r=!0)},o(n){D(s.$$.fragment,n),r=!1},d(n){n&&w(e),n&&w(t),O(s,n)}}}function Nt(l){let e,t=l[2].strings.references+"",s,r,n=[],i=new Map,a,o,f=l[1].references;const c=m=>m[4].id;for(let m=0;m<f.length;m+=1){let u=Dt(l,f,m),_=c(u);i.set(_,n[m]=jt(_,u))}return{c(){e=v("div"),s=B(t),r=z();for(let m=0;m<n.length;m+=1)n[m].c();a=ce(),d(e,"class","alert alert-secondary mt-4 mb-4 text-center")},m(m,u){k(m,e,u),g(e,s),k(m,r,u);for(let _=0;_<n.length;_+=1)n[_]&&n[_].m(m,u);k(m,a,u),o=!0},p(m,u){(!o||u&4)&&t!==(t=m[2].strings.references+"")&&q(s,t),u&2&&(f=m[1].references,x(),n=we(n,u,c,1,m,f,i,a.parentNode,Ze,jt,a,Dt),ee())},i(m){if(!o){for(let u=0;u<f.length;u+=1)S(n[u]);o=!0}},o(m){for(let u=0;u<n.length;u+=1)D(n[u]);o=!1},d(m){m&&w(e),m&&w(r);for(let u=0;u<n.length;u+=1)n[u].d(m);m&&w(a)}}}function jt(l,e){let t,s,r;return s=new rn({props:{reference:e[4]}}),{key:l,first:null,c(){t=ce(),G(s.$$.fragment),this.first=t},m(n,i){k(n,t,i),H(s,n,i),r=!0},p(n,i){e=n;const a={};i&2&&(a.reference=e[4]),s.$set(a)},i(n){r||(S(s.$$.fragment,n),r=!0)},o(n){D(s.$$.fragment,n),r=!1},d(n){n&&w(t),O(s,n)}}}function un(l){let e,t,s,r=l[1].subject+"",n,i,a,o,f,c,m,u,_=l[1].fulltime+"",b,p,h,y,C,A,M,$,T,L,N=l[1].content+"",P,W,j,J,se,R,Y,re,oe;f=new sn({props:{store:l[0],message:l[1]}}),y=new Ol({props:{store:l[0],message:l[1],canReplyAll:l[3]}}),A=new fn({props:{store:l[0],message:l[1]}});let Z=l[1].attachments.length>0&&At(l);R=new Yl({props:{store:l[0],message:l[1],canReplyAll:l[3]}});let Q=l[1].references.length>0&&Nt(l);return{c(){e=v("div"),t=v("div"),s=v("h3"),n=B(r),i=z(),a=v("div"),o=v("div"),G(f.$$.fragment),c=z(),m=v("div"),u=v("div"),b=B(_),p=z(),h=v("div"),G(y.$$.fragment),C=z(),G(A.$$.fragment),M=z(),$=v("hr"),T=z(),L=v("div"),P=z(),Z&&Z.c(),W=z(),j=v("hr"),J=z(),se=v("div"),G(R.$$.fragment),Y=z(),Q&&Q.c(),re=ce(),d(s,"class","h4 card-title mb-3 mb-md-2"),d(o,"class","d-flex flex-wrap mx-n2 mt-2"),ie(o,"min-width","0"),d(u,"class","my-2 text-truncate"),d(h,"class","d-flex flex-shrink-0 ml-3 mr-n2"),d(m,"class","d-flex justify-content-between flex-shrink-0 ml-auto"),d(a,"class","d-md-flex align-items-start mb-2"),d(L,"class","local-mail-message-content svelte-18ecame"),d(se,"class","mt-3 d-flex mr-n3 mb-n3 flex-column flex-sm-row justify-content-end"),d(t,"class","card-body p-3 px-xl-4"),d(e,"class","card")},m(U,X){k(U,e,X),g(e,t),g(t,s),g(s,n),g(t,i),g(t,a),g(a,o),H(f,o,null),g(a,c),g(a,m),g(m,u),g(u,b),g(m,p),g(m,h),H(y,h,null),g(t,C),H(A,t,null),g(t,M),g(t,$),g(t,T),g(t,L),L.innerHTML=N,g(t,P),Z&&Z.m(t,null),g(t,W),g(t,j),g(t,J),g(t,se),H(R,se,null),k(U,Y,X),Q&&Q.m(U,X),k(U,re,X),oe=!0},p(U,[X]){(!oe||X&2)&&r!==(r=U[1].subject+"")&&q(n,r);const me={};X&1&&(me.store=U[0]),X&2&&(me.message=U[1]),f.$set(me),(!oe||X&2)&&_!==(_=U[1].fulltime+"")&&q(b,_);const pe={};X&1&&(pe.store=U[0]),X&2&&(pe.message=U[1]),X&8&&(pe.canReplyAll=U[3]),y.$set(pe);const E={};X&1&&(E.store=U[0]),X&2&&(E.message=U[1]),A.$set(E),(!oe||X&2)&&N!==(N=U[1].content+"")&&(L.innerHTML=N),U[1].attachments.length>0?Z?(Z.p(U,X),X&2&&S(Z,1)):(Z=At(U),Z.c(),S(Z,1),Z.m(t,W)):Z&&(x(),D(Z,1,1,()=>{Z=null}),ee());const V={};X&1&&(V.store=U[0]),X&2&&(V.message=U[1]),X&8&&(V.canReplyAll=U[3]),R.$set(V),U[1].references.length>0?Q?(Q.p(U,X),X&2&&S(Q,1)):(Q=Nt(U),Q.c(),S(Q,1),Q.m(re.parentNode,re)):Q&&(x(),D(Q,1,1,()=>{Q=null}),ee())},i(U){oe||(S(f.$$.fragment,U),S(y.$$.fragment,U),S(A.$$.fragment,U),S(Z),S(R.$$.fragment,U),S(Q),oe=!0)},o(U){D(f.$$.fragment,U),D(y.$$.fragment,U),D(A.$$.fragment,U),D(Z),D(R.$$.fragment,U),D(Q),oe=!1},d(U){U&&w(e),O(f),O(y),O(A),Z&&Z.d(),O(R),U&&w(Y),Q&&Q.d(U),U&&w(re)}}}function cn(l,e,t){let s,r,n=I,i=()=>(n(),n=ae(a,f=>t(2,r=f)),a);l.$$.on_destroy.push(()=>n());let{store:a}=e;i();let{message:o}=e;return l.$$set=f=>{"store"in f&&i(t(0,a=f.store)),"message"in f&&t(1,o=f.message)},l.$$.update=()=>{l.$$.dirty&6&&t(3,s=o.sender.id==r.userid?o.recipients.filter(f=>f.type=="cc").length>0:o.recipients.filter(f=>["to","cc"].includes(f.type)&&f.id!=r.userid).length>0)},[a,o,r,s]}class mn extends le{constructor(e){super(),ne(this,e,cn,un,te,{store:0,message:1})}}function dn(l){let e,t,s,r,n,i;return{c(){e=v("button"),t=v("i"),d(t,"class","fa fa-fw fa-trash"),d(e,"type","button"),d(e,"class","local-mail-action-delete btn flex-grow-0"),e.disabled=s=!l[2].selectedMessages.size,d(e,"title",r=l[2].strings.delete),F(e,"btn-secondary",!l[1]),F(e,"disabled",!l[2].selectedMessages.size)},m(a,o){k(a,e,o),g(e,t),n||(i=K(e,"click",l[3]),n=!0)},p(a,[o]){o&4&&s!==(s=!a[2].selectedMessages.size)&&(e.disabled=s),o&4&&r!==(r=a[2].strings.delete)&&d(e,"title",r),o&2&&F(e,"btn-secondary",!a[1]),o&4&&F(e,"disabled",!a[2].selectedMessages.size)},i:I,o:I,d(a){a&&w(e),n=!1,i()}}}function _n(l,e,t){let s,r=I,n=()=>(r(),r=ae(i,f=>t(2,s=f)),i);l.$$.on_destroy.push(()=>r());let{store:i}=e;n();let{transparent:a=!1}=e;const o=()=>i.setDeleted(Array.from(s.selectedMessages.keys()),Ce.Deleted,!0);return l.$$set=f=>{"store"in f&&n(t(0,i=f.store)),"transparent"in f&&t(1,a=f.transparent)},[i,a,s,o]}class sl extends le{constructor(e){super(),ne(this,e,_n,dn,te,{store:0,transparent:1})}}function Bt(l){let e,t;return e=new Ee({props:{title:l[3].strings.deleteforever,cancelText:l[3].strings.cancel,confirmText:l[3].strings.deleteforever,confirmClass:"btn-danger",handleCancel:l[5],handleConfirm:l[6],$$slots:{default:[gn]},$$scope:{ctx:l}}}),{c(){G(e.$$.fragment)},m(s,r){H(e,s,r),t=!0},p(s,r){const n={};r&8&&(n.title=s[3].strings.deleteforever),r&8&&(n.cancelText=s[3].strings.cancel),r&8&&(n.confirmText=s[3].strings.deleteforever),r&136&&(n.$$scope={dirty:r,ctx:s}),e.$set(n)},i(s){t||(S(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function gn(l){let e=l[3].strings.messagedeleteconfirm+"",t;return{c(){t=B(e)},m(s,r){k(s,t,r)},p(s,r){r&8&&e!==(e=s[3].strings.messagedeleteconfirm+"")&&q(t,e)},d(s){s&&w(t)}}}function pn(l){let e,t,s,r,n,i,a,o,f,c=l[2]&&Bt(l);return{c(){e=v("button"),t=v("i"),n=z(),c&&c.c(),i=ce(),d(t,"class","fa fa-fw fa-trash"),d(e,"type","button"),d(e,"class","local-mail-action-delete-forever btn flex-grow-0"),e.disabled=s=!l[3].selectedMessages.size,d(e,"title",r=l[3].strings.deleteforever),F(e,"btn-secondary",!l[1]),F(e,"disabled",!l[3].selectedMessages.size)},m(m,u){k(m,e,u),g(e,t),k(m,n,u),c&&c.m(m,u),k(m,i,u),a=!0,o||(f=K(e,"click",l[4]),o=!0)},p(m,[u]){(!a||u&8&&s!==(s=!m[3].selectedMessages.size))&&(e.disabled=s),(!a||u&8&&r!==(r=m[3].strings.deleteforever))&&d(e,"title",r),(!a||u&2)&&F(e,"btn-secondary",!m[1]),(!a||u&8)&&F(e,"disabled",!m[3].selectedMessages.size),m[2]?c?(c.p(m,u),u&4&&S(c,1)):(c=Bt(m),c.c(),S(c,1),c.m(i.parentNode,i)):c&&(x(),D(c,1,1,()=>{c=null}),ee())},i(m){a||(S(c),a=!0)},o(m){D(c),a=!1},d(m){m&&w(e),m&&w(n),c&&c.d(m),m&&w(i),o=!1,f()}}}function bn(l,e,t){let s,r=I,n=()=>(r(),r=ae(i,u=>t(3,s=u)),i);l.$$.on_destroy.push(()=>r());let{store:i}=e;n();let{transparent:a=!1}=e,o=!1;const f=()=>{t(2,o=!0)},c=()=>{t(2,o=!1)},m=()=>{t(2,o=!1),i.setDeleted(Array.from(s.selectedMessages.keys()),Ce.DeletedForever,!0)};return l.$$set=u=>{"store"in u&&n(t(0,i=u.store)),"transparent"in u&&t(1,a=u.transparent)},[i,a,o,s,f,c,m]}class ll extends le{constructor(e){super(),ne(this,e,bn,pn,te,{store:0,transparent:1})}}function It(l,e,t){const s=l.slice();return s[16]=e[t],s}function hn(l){let e;return{c(){e=v("span"),e.textContent="a",d(e,"aria-hidden","true")},m(t,s){k(t,e,s)},d(t){t&&w(e)}}}function vn(l){let e;return{c(){e=v("i"),d(e,"class","fa fa-check local-mail-label-modal-color-option-check")},m(t,s){k(t,e,s)},d(t){t&&w(e)}}}function qt(l,e){let t,s,r,n,i,a;function o(u,_){return u[16]==u[7]?vn:hn}let f=o(e),c=f(e);function m(){return e[15](e[16])}return{key:l,first:null,c(){t=v("button"),c.c(),s=z(),d(t,"role","radio"),d(t,"aria-checked",r=e[16]==e[7]),d(t,"tabindex","0"),d(t,"title",n=e[5].strings[`color${e[16]}`]),d(t,"class","local-mail-label-modal-color-option btn svelte-cky3j8"),d(t,"style",`color: var(--local-mail-color-${e[16]}-fg, var(--local-mail-color-gray-fg));background-color: var(--local-mail-color-${e[16]}-bg, var(--local-mail-color-gray-bg))`),this.first=t},m(u,_){k(u,t,_),c.m(t,null),g(t,s),i||(a=K(t,"click",ke(m)),i=!0)},p(u,_){e=u,f!==(f=o(e))&&(c.d(1),c=f(e),c&&(c.c(),c.m(t,s))),_&128&&r!==(r=e[16]==e[7])&&d(t,"aria-checked",r),_&32&&n!==(n=e[5].strings[`color${e[16]}`])&&d(t,"title",n)},d(u){u&&w(t),c.d(),i=!1,a()}}}function kn(l){let e,t,s,r=l[5].strings.labelname+"",n,i,a,o,f,c,m=l[5].strings[l[4]?"errorrepeatedlabelname":"erroremptylabelname"]+"",u,_,b,p,h,y,C=l[5].strings.labelcolor+"",A,M,$,T,L=[],N=new Map,P,W,j,J=Ke;const se=R=>R[16];for(let R=0;R<J.length;R+=1){let Y=It(l,J,R),re=se(Y);N.set(re,L[R]=qt(re,Y))}return{c(){e=v("form"),t=v("div"),s=v("label"),n=B(r),i=z(),a=v("input"),f=z(),c=v("div"),u=B(m),_=z(),b=v("div"),b.textContent=" ",p=z(),h=v("div"),y=v("label"),A=B(C),$=z(),T=v("div");for(let R=0;R<L.length;R+=1)L[R].c();d(s,"for","local-mail-label-modal-name"),d(a,"type","text"),a.required=!0,d(a,"class","form-control is-invalid"),d(a,"id",o=l[9]+"-name"),F(a,"is-valid",l[8]),F(a,"is-invalid",!l[8]),d(c,"class","invalid-feedback"),d(b,"class","valid-feedback"),d(t,"class","form-group"),d(y,"for",M=l[9]+"-color"),d(T,"role","radiogroup"),d(T,"class","local-mail-label-modal-color svelte-cky3j8"),d(T,"id",P=l[9]+"-color"),d(h,"class","form-group")},m(R,Y){k(R,e,Y),g(e,t),g(t,s),g(s,n),g(t,i),g(t,a),l[13](a),ve(a,l[3]),g(t,f),g(t,c),g(c,u),g(t,_),g(t,b),g(e,p),g(e,h),g(h,y),g(y,A),g(h,$),g(h,T);for(let re=0;re<L.length;re+=1)L[re]&&L[re].m(T,null);W||(j=[K(a,"input",l[14]),K(e,"submit",ke(l[10]))],W=!0)},p(R,Y){Y&32&&r!==(r=R[5].strings.labelname+"")&&q(n,r),Y&512&&o!==(o=R[9]+"-name")&&d(a,"id",o),Y&8&&a.value!==R[3]&&ve(a,R[3]),Y&256&&F(a,"is-valid",R[8]),Y&256&&F(a,"is-invalid",!R[8]),Y&48&&m!==(m=R[5].strings[R[4]?"errorrepeatedlabelname":"erroremptylabelname"]+"")&&q(u,m),Y&32&&C!==(C=R[5].strings.labelcolor+"")&&q(A,C),Y&512&&M!==(M=R[9]+"-color")&&d(y,"for",M),Y&160&&(J=Ke,L=we(L,Y,se,1,R,J,N,T,Ye,qt,null,It)),Y&512&&P!==(P=R[9]+"-color")&&d(T,"id",P)},d(R){R&&w(e),l[13](null);for(let Y=0;Y<L.length;Y+=1)L[Y].d();W=!1,_e(j)}}}function wn(l){let e,t;return e=new Ee({props:{title:l[5].strings[l[1]?"editlabel":"newlabel"],cancelText:l[5].strings.cancel,handleCancel:l[2],confirmText:l[5].strings[l[1]?"save":"create"],confirmDisabled:!l[8],handleConfirm:l[10],$$slots:{default:[kn]},$$scope:{ctx:l}}}),{c(){G(e.$$.fragment)},m(s,r){H(e,s,r),t=!0},p(s,[r]){const n={};r&34&&(n.title=s[5].strings[s[1]?"editlabel":"newlabel"]),r&32&&(n.cancelText=s[5].strings.cancel),r&4&&(n.handleCancel=s[2]),r&34&&(n.confirmText=s[5].strings[s[1]?"save":"create"]),r&256&&(n.confirmDisabled=!s[8]),r&525304&&(n.$$scope={dirty:r,ctx:s}),e.$set(n)},i(s){t||(S(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function yn(l,e,t){let s,r,n,i,a,o,f,c=I,m=()=>(c(),c=ae(u,$=>t(5,f=$)),u);l.$$.on_destroy.push(()=>c());let{store:u}=e;m();let{label:_=void 0}=e,{handleCancel:b}=e,{handleSubmit:p}=e,h;const y=async()=>{p(r,n)};We(()=>h.focus());function C($){ge[$?"unshift":"push"](()=>{h=$,t(6,h)})}function A(){r=this.value,t(3,r),t(1,_)}const M=$=>{t(7,n=$)};return l.$$set=$=>{"store"in $&&m(t(0,u=$.store)),"label"in $&&t(1,_=$.label),"handleCancel"in $&&t(2,b=$.handleCancel),"handleSubmit"in $&&t(11,p=$.handleSubmit)},l.$$.update=()=>{l.$$.dirty&2&&t(9,s=`local-mail-label-modal-${(_==null?void 0:_.id)||"new"}`),l.$$.dirty&2&&t(3,r=(_==null?void 0:_.name)||""),l.$$.dirty&2&&t(7,n=(_==null?void 0:_.color)||Ke[0]),l.$$.dirty&8&&t(12,i=at(r)==""),l.$$.dirty&42&&t(4,a=f.labels.some($=>$.id!=(_==null?void 0:_.id)&&$.name==at(r))),l.$$.dirty&4112&&t(8,o=!i&&!a)},[u,_,b,r,a,f,h,n,o,s,y,p,i,C,A,M]}class nl extends le{constructor(e){super(),ne(this,e,yn,wn,te,{store:0,label:1,handleCancel:2,handleSubmit:11})}}const{Map:Mn}=Xe;function Rt(l,e,t){const s=l.slice();return s[16]=e[t],s}function Et(l){let e,t=[],s=new Mn,r,n,i=l[3].labels;const a=u=>u[16].id;for(let u=0;u<i.length;u+=1){let _=Rt(l,i,u),b=a(_);s.set(b,t[u]=Pt(b,_))}let o=l[3].labels.length>0&&Ft();function f(u,_){return u[7]?Sn:$n}let c=f(l),m=c(l);return{c(){e=v("div");for(let u=0;u<t.length;u+=1)t[u].c();r=z(),o&&o.c(),n=z(),m.c(),d(e,"class","dropdown-menu show")},m(u,_){k(u,e,_);for(let b=0;b<t.length;b+=1)t[b]&&t[b].m(e,null);g(e,r),o&&o.m(e,null),g(e,n),m.m(e,null)},p(u,_){_&1096&&(i=u[3].labels,t=we(t,_,a,1,u,i,s,e,Ye,Pt,r,Rt)),u[3].labels.length>0?o||(o=Ft(),o.c(),o.m(e,n)):o&&(o.d(1),o=null),c===(c=f(u))&&m?m.p(u,_):(m.d(1),m=c(u),m&&(m.c(),m.m(e,null)))},d(u){u&&w(e);for(let _=0;_<t.length;_+=1)t[_].d();o&&o.d(),m.d()}}}function Pt(l,e){let t,s,r,n,i=e[16].name+"",a,o,f;function c(){return e[15](e[16])}return{key:l,first:null,c(){t=v("button"),s=v("i"),n=z(),a=B(i),d(s,"class",r="fa fa-fw "+e[6](e[16].id)+" svelte-ufjoxg"),d(t,"type","button"),d(t,"class","dropdown-item local-mail-action-label-button-item"),this.first=t},m(m,u){k(m,t,u),g(t,s),g(t,n),g(t,a),o||(f=K(t,"click",c),o=!0)},p(m,u){e=m,u&72&&r!==(r="fa fa-fw "+e[6](e[16].id)+" svelte-ufjoxg")&&d(s,"class",r),u&8&&i!==(i=e[16].name+"")&&q(a,i)},d(m){m&&w(t),o=!1,f()}}}function Ft(l){let e;return{c(){e=v("div"),d(e,"class","dropdown-divider")},m(t,s){k(t,e,s)},d(t){t&&w(e)}}}function $n(l){let e,t=l[3].strings.newlabel+"",s,r,n;return{c(){e=v("button"),s=B(t),d(e,"type","button"),d(e,"class","dropdown-item local-mail-action-label-button-item")},m(i,a){k(i,e,a),g(e,s),r||(n=K(e,"click",l[12]),r=!0)},p(i,a){a&8&&t!==(t=i[3].strings.newlabel+"")&&q(s,t)},d(i){i&&w(e),r=!1,n()}}}function Sn(l){let e,t=l[3].strings.applychanges+"",s,r,n;return{c(){e=v("button"),s=B(t),d(e,"type","button"),d(e,"class","dropdown-item local-mail-action-label-button-item")},m(i,a){k(i,e,a),g(e,s),r||(n=K(e,"click",l[11]),r=!0)},p(i,a){a&8&&t!==(t=i[3].strings.applychanges+"")&&q(s,t)},d(i){i&&w(e),r=!1,n()}}}function Ut(l){let e,t;return e=new nl({props:{store:l[0],handleCancel:l[9],handleSubmit:l[13]}}),{c(){G(e.$$.fragment)},m(s,r){H(e,s,r),t=!0},p(s,r){const n={};r&1&&(n.store=s[0]),e.$set(n)},i(s){t||(S(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function Cn(l){let e,t,s,r,n,i,a,o,f,c,m=l[4]&&Et(l),u=l[5]&&Ut(l);return{c(){e=v("div"),t=v("button"),s=v("i"),i=z(),m&&m.c(),a=z(),u&&u.c(),d(s,"class","fa fa-fw fa-tag"),d(t,"type","button"),d(t,"class","local-mail-action-label-button btn dropdown-toggle svelte-ufjoxg"),t.disabled=r=!l[3].selectedMessages.size,d(t,"aria-expanded",l[4]),d(t,"title",n=l[3].strings.labels),F(t,"btn-secondary",!l[1]),F(t,"disabled",!l[3].selectedMessages.size),d(e,"class","btn-group"),d(e,"role","group"),F(e,"dropup",l[2])},m(_,b){k(_,e,b),g(e,t),g(t,s),g(e,i),m&&m.m(e,null),g(e,a),u&&u.m(e,null),o=!0,f||(c=[K(t,"click",l[8]),he(ze.call(null,e,l[9]))],f=!0)},p(_,[b]){(!o||b&8&&r!==(r=!_[3].selectedMessages.size))&&(t.disabled=r),(!o||b&16)&&d(t,"aria-expanded",_[4]),(!o||b&8&&n!==(n=_[3].strings.labels))&&d(t,"title",n),(!o||b&2)&&F(t,"btn-secondary",!_[1]),(!o||b&8)&&F(t,"disabled",!_[3].selectedMessages.size),_[4]?m?m.p(_,b):(m=Et(_),m.c(),m.m(e,a)):m&&(m.d(1),m=null),_[5]?u?(u.p(_,b),b&32&&S(u,1)):(u=Ut(_),u.c(),S(u,1),u.m(e,null)):u&&(x(),D(u,1,1,()=>{u=null}),ee()),(!o||b&4)&&F(e,"dropup",_[2])},i(_){o||(S(u),o=!0)},o(_){D(u),o=!1},d(_){_&&w(e),m&&m.d(),u&&u.d(),f=!1,_e(c)}}}function Tn(l,e,t){let s,r,n,i=I,a=()=>(i(),i=ae(o,$=>t(3,n=$)),o);l.$$.on_destroy.push(()=>i());let{store:o}=e;a();let{transparent:f=!1}=e,{dropup:c=!1}=e,m=!1,u=!1,_=new Map;const b=()=>{t(4,m=!m)},p=()=>{t(4,m=!1),t(5,u=!1)},h=$=>{t(14,_=new Map(Array.from(_.entries()).map(([T,L])=>[T,T==$?L=="true"?"false":"true":L])))},y=()=>{t(4,m=!1),o.setLabels(Array.from(n.selectedMessages.keys()),Array.from(_.keys()).filter($=>_.get($)=="true"),Array.from(_.keys()).filter($=>_.get($)=="false"))},C=()=>{t(4,m=!1),t(5,u=!0)},A=async($,T)=>{t(5,u=!1);const L=await o.createLabel($,T);L&&o.setLabels(Array.from(n.selectedMessages.keys()),[L],[])},M=$=>h($.id);return l.$$set=$=>{"store"in $&&a(t(0,o=$.store)),"transparent"in $&&t(1,f=$.transparent),"dropup"in $&&t(2,c=$.dropup)},l.$$.update=()=>{l.$$.dirty&8&&t(14,_=new Map(n.labels.map($=>{const T=Array.from(n.selectedMessages.values()).filter(L=>L.labels.some(N=>N.id==$.id));return[$.id,T.length==0?"false":T.length<n.selectedMessages.size?"mixed":"true"]}))),l.$$.dirty&16392&&t(7,s=Array.from(_.entries()).some(([$,T])=>n.listMessages.some(L=>n.selectedMessages.has(L.id)&&(T=="true"&&L.labels.every(N=>N.id!=$)||T=="false"&&L.labels.some(N=>N.id==$))))),l.$$.dirty&16384&&t(6,r=$=>_.get($)=="false"?"fa-square-o":_.get($)=="mixed"?"fa-minus-square-o":"fa-check-square-o")},[o,f,c,n,m,u,r,s,b,p,h,y,C,A,_,M]}class rl extends le{constructor(e){super(),ne(this,e,Tn,Cn,te,{store:0,transparent:1,dropup:2})}}function Gt(l){let e;function t(n,i){return n[8].params.tray=="trash"?Ln:zn}let s=t(l),r=s(l);return{c(){e=v("div"),r.c(),d(e,"class","dropdown-menu show")},m(n,i){k(n,e,i),r.m(e,null)},p(n,i){s===(s=t(n))&&r?r.p(n,i):(r.d(1),r=s(n),r&&(r.c(),r.m(e,null)))},d(n){n&&w(e),r.d()}}}function zn(l){let e,t,s,r,n,i=l[6]&&Ht(l),a=l[7]&&Ot(l),o=l[4]&&Kt(l),f=l[5]&&Vt(l),c=l[3]&&Wt(l);return{c(){i&&i.c(),e=z(),a&&a.c(),t=z(),o&&o.c(),s=z(),f&&f.c(),r=z(),c&&c.c(),n=ce()},m(m,u){i&&i.m(m,u),k(m,e,u),a&&a.m(m,u),k(m,t,u),o&&o.m(m,u),k(m,s,u),f&&f.m(m,u),k(m,r,u),c&&c.m(m,u),k(m,n,u)},p(m,u){m[6]?i?i.p(m,u):(i=Ht(m),i.c(),i.m(e.parentNode,e)):i&&(i.d(1),i=null),m[7]?a?a.p(m,u):(a=Ot(m),a.c(),a.m(t.parentNode,t)):a&&(a.d(1),a=null),m[4]?o?o.p(m,u):(o=Kt(m),o.c(),o.m(s.parentNode,s)):o&&(o.d(1),o=null),m[5]?f?f.p(m,u):(f=Vt(m),f.c(),f.m(r.parentNode,r)):f&&(f.d(1),f=null),m[3]?c?c.p(m,u):(c=Wt(m),c.c(),c.m(n.parentNode,n)):c&&(c.d(1),c=null)},d(m){i&&i.d(m),m&&w(e),a&&a.d(m),m&&w(t),o&&o.d(m),m&&w(s),f&&f.d(m),m&&w(r),c&&c.d(m),m&&w(n)}}}function Ln(l){let e,t=l[8].strings.emptytrash+"",s,r,n;return{c(){e=v("button"),s=B(t),d(e,"type","button"),d(e,"class","dropdown-item")},m(i,a){k(i,e,a),g(e,s),r||(n=K(e,"click",l[24]),r=!0)},p(i,a){a[0]&256&&t!==(t=i[8].strings.emptytrash+"")&&q(s,t)},d(i){i&&w(e),r=!1,n()}}}function Ht(l){let e,t=l[8].strings.markasread+"",s,r,n;return{c(){e=v("button"),s=B(t),d(e,"type","button"),d(e,"class","dropdown-item")},m(i,a){k(i,e,a),g(e,s),r||(n=K(e,"click",l[28]),r=!0)},p(i,a){a[0]&256&&t!==(t=i[8].strings.markasread+"")&&q(s,t)},d(i){i&&w(e),r=!1,n()}}}function Ot(l){let e,t=l[8].strings.markasunread+"",s,r,n;return{c(){e=v("button"),s=B(t),d(e,"type","button"),d(e,"class","dropdown-item")},m(i,a){k(i,e,a),g(e,s),r||(n=K(e,"click",l[29]),r=!0)},p(i,a){a[0]&256&&t!==(t=i[8].strings.markasunread+"")&&q(s,t)},d(i){i&&w(e),r=!1,n()}}}function Kt(l){let e,t=l[8].strings.markasstarred+"",s,r,n;return{c(){e=v("button"),s=B(t),d(e,"type","button"),d(e,"class","dropdown-item")},m(i,a){k(i,e,a),g(e,s),r||(n=K(e,"click",l[30]),r=!0)},p(i,a){a[0]&256&&t!==(t=i[8].strings.markasstarred+"")&&q(s,t)},d(i){i&&w(e),r=!1,n()}}}function Vt(l){let e,t=l[8].strings.markasunstarred+"",s,r,n;return{c(){e=v("button"),s=B(t),d(e,"type","button"),d(e,"class","dropdown-item")},m(i,a){k(i,e,a),g(e,s),r||(n=K(e,"click",l[31]),r=!0)},p(i,a){a[0]&256&&t!==(t=i[8].strings.markasunstarred+"")&&q(s,t)},d(i){i&&w(e),r=!1,n()}}}function Wt(l){let e,t,s=l[8].strings.editlabel+"",r,n,i,a=l[8].strings.deletelabel+"",o,f,c,m=(l[6]||l[7]||l[4]||l[5])&&Xt();return{c(){m&&m.c(),e=z(),t=v("button"),r=B(s),n=z(),i=v("button"),o=B(a),d(t,"type","button"),d(t,"class","dropdown-item"),d(i,"type","button"),d(i,"class","dropdown-item")},m(u,_){m&&m.m(u,_),k(u,e,_),k(u,t,_),g(t,r),k(u,n,_),k(u,i,_),g(i,o),f||(c=[K(t,"click",l[18]),K(i,"click",l[21])],f=!0)},p(u,_){u[6]||u[7]||u[4]||u[5]?m||(m=Xt(),m.c(),m.m(e.parentNode,e)):m&&(m.d(1),m=null),_[0]&256&&s!==(s=u[8].strings.editlabel+"")&&q(r,s),_[0]&256&&a!==(a=u[8].strings.deletelabel+"")&&q(o,a)},d(u){m&&m.d(u),u&&w(e),u&&w(t),u&&w(n),u&&w(i),f=!1,_e(c)}}}function Xt(l){let e;return{c(){e=v("div"),d(e,"class","dropdown-divider")},m(t,s){k(t,e,s)},d(t){t&&w(e)}}}function Dn(l){let e,t,s,r=l[10]&&Yt(l),n=l[11]&&Jt(l);return{c(){r&&r.c(),e=z(),n&&n.c(),t=ce()},m(i,a){r&&r.m(i,a),k(i,e,a),n&&n.m(i,a),k(i,t,a),s=!0},p(i,a){i[10]?r?(r.p(i,a),a[0]&1024&&S(r,1)):(r=Yt(i),r.c(),S(r,1),r.m(e.parentNode,e)):r&&(x(),D(r,1,1,()=>{r=null}),ee()),i[11]?n?(n.p(i,a),a[0]&2048&&S(n,1)):(n=Jt(i),n.c(),S(n,1),n.m(t.parentNode,t)):n&&(x(),D(n,1,1,()=>{n=null}),ee())},i(i){s||(S(r),S(n),s=!0)},o(i){D(r),D(n),s=!1},d(i){r&&r.d(i),i&&w(e),n&&n.d(i),i&&w(t)}}}function An(l){let e,t,s=l[12]&&Qt(l);return{c(){s&&s.c(),e=ce()},m(r,n){s&&s.m(r,n),k(r,e,n),t=!0},p(r,n){r[12]?s?(s.p(r,n),n[0]&4096&&S(s,1)):(s=Qt(r),s.c(),S(s,1),s.m(e.parentNode,e)):s&&(x(),D(s,1,1,()=>{s=null}),ee())},i(r){t||(S(s),t=!0)},o(r){D(s),t=!1},d(r){s&&s.d(r),r&&w(e)}}}function Yt(l){let e,t;return e=new nl({props:{store:l[0],label:l[3],handleCancel:l[19],handleSubmit:l[20]}}),{c(){G(e.$$.fragment)},m(s,r){H(e,s,r),t=!0},p(s,r){const n={};r[0]&1&&(n.store=s[0]),r[0]&8&&(n.label=s[3]),e.$set(n)},i(s){t||(S(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function Jt(l){let e,t;return e=new Ee({props:{title:l[8].strings.deletelabel,cancelText:l[8].strings.cancel,confirmText:l[8].strings.deletelabel,confirmClass:"btn-danger",handleCancel:l[22],handleConfirm:l[23],$$slots:{default:[Nn]},$$scope:{ctx:l}}}),{c(){G(e.$$.fragment)},m(s,r){H(e,s,r),t=!0},p(s,r){const n={};r[0]&256&&(n.title=s[8].strings.deletelabel),r[0]&256&&(n.cancelText=s[8].strings.cancel),r[0]&256&&(n.confirmText=s[8].strings.deletelabel),r[0]&264|r[1]&2&&(n.$$scope={dirty:r,ctx:s}),e.$set(n)},i(s){t||(S(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function Nn(l){let e=Me(l[8].strings.labeldeleteconfirm,l[3].name)+"",t;return{c(){t=B(e)},m(s,r){k(s,t,r)},p(s,r){r[0]&264&&e!==(e=Me(s[8].strings.labeldeleteconfirm,s[3].name)+"")&&q(t,e)},d(s){s&&w(t)}}}function Qt(l){let e,t;return e=new Ee({props:{title:l[8].strings.emptytrash,cancelText:l[8].strings.cancel,confirmText:l[8].strings.emptytrash,confirmClass:"btn-danger",handleCancel:l[25],handleConfirm:l[26],$$slots:{default:[jn]},$$scope:{ctx:l}}}),{c(){G(e.$$.fragment)},m(s,r){H(e,s,r),t=!0},p(s,r){const n={};r[0]&256&&(n.title=s[8].strings.emptytrash),r[0]&256&&(n.cancelText=s[8].strings.cancel),r[0]&256&&(n.confirmText=s[8].strings.emptytrash),r[0]&256|r[1]&2&&(n.$$scope={dirty:r,ctx:s}),e.$set(n)},i(s){t||(S(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function jn(l){let e=l[8].strings.emptytrashconfirm+"",t;return{c(){t=B(e)},m(s,r){k(s,t,r)},p(s,r){r[0]&256&&e!==(e=s[8].strings.emptytrashconfirm+"")&&q(t,e)},d(s){s&&w(t)}}}function Bn(l){let e,t,s,r,n,i,a,o,f,c,m,u=l[9]&&Gt(l);const _=[An,Dn],b=[];function p(h,y){return h[8].params.tray=="trash"?0:h[3]?1:-1}return~(a=p(l))&&(o=b[a]=_[a](l)),{c(){e=v("div"),t=v("button"),s=v("i"),n=z(),u&&u.c(),i=z(),o&&o.c(),d(s,"class","fa fa-fw fa-ellipsis-v"),d(t,"type","button"),d(t,"class","local-mail-action-more-button btn dropdown-toggle svelte-kx0nzt"),t.disabled=l[13],d(t,"aria-expanded",l[9]),d(t,"title",r=l[8].strings.moreactions),F(t,"btn-secondary",!l[1]),F(t,"disabled",l[13]),d(e,"class","btn-group"),F(e,"dropup",l[2])},m(h,y){k(h,e,y),g(e,t),g(t,s),g(e,n),u&&u.m(e,null),g(e,i),~a&&b[a].m(e,null),f=!0,c||(m=[K(t,"click",l[15]),he(ze.call(null,e,l[14]))],c=!0)},p(h,y){(!f||y[0]&8192)&&(t.disabled=h[13]),(!f||y[0]&512)&&d(t,"aria-expanded",h[9]),(!f||y[0]&256&&r!==(r=h[8].strings.moreactions))&&d(t,"title",r),(!f||y[0]&2)&&F(t,"btn-secondary",!h[1]),(!f||y[0]&8192)&&F(t,"disabled",h[13]),h[9]?u?u.p(h,y):(u=Gt(h),u.c(),u.m(e,i)):u&&(u.d(1),u=null);let C=a;a=p(h),a===C?~a&&b[a].p(h,y):(o&&(x(),D(b[C],1,1,()=>{b[C]=null}),ee()),~a?(o=b[a],o?o.p(h,y):(o=b[a]=_[a](h),o.c()),S(o,1),o.m(e,null)):o=null),(!f||y[0]&4)&&F(e,"dropup",h[2])},i(h){f||(S(o),f=!0)},o(h){D(o),f=!1},d(h){h&&w(e),u&&u.d(),~a&&b[a].d(),c=!1,_e(m)}}}function In(l,e,t){let s,r,n,i,a,o,f,c,m=I,u=()=>(m(),m=ae(_,X=>t(8,c=X)),_);l.$$.on_destroy.push(()=>m());let{store:_}=e;u();let{transparent:b=!1}=e,{dropup:p=!1}=e,h=!1,y=!1,C=!1,A=!1;const M=()=>{t(9,h=!1)},$=()=>{t(9,h=!h)},T=X=>{t(9,h=!1),_.setUnread(r.map(me=>me.id),X)},L=X=>{t(9,h=!1),_.setStarred(r.map(me=>me.id),X)},N=()=>{t(9,h=!1),t(10,y=!0)},P=()=>{t(10,y=!1)},W=async(X,me)=>{t(10,y=!1),s&&_.updateLabel(s.id,X,me)},j=()=>{t(9,h=!1),t(11,C=!0)},J=()=>{t(11,C=!1)},se=()=>{t(11,C=!1),_.deleteLabel(c.params.labelid||0)},R=()=>{t(9,h=!1),t(12,A=!0)},Y=()=>{t(12,A=!1)},re=()=>{t(12,A=!1),_.emptyTrash()},oe=()=>T(!1),Z=()=>T(!0),Q=()=>L(!0),U=()=>L(!1);return l.$$set=X=>{"store"in X&&u(t(0,_=X.store)),"transparent"in X&&t(1,b=X.transparent),"dropup"in X&&t(2,p=X.dropup)},l.$$.update=()=>{l.$$.dirty[0]&256&&t(3,s=c.params.tray=="label"&&c.message==null?c.labels.find(X=>X.id==c.params.labelid):null),l.$$.dirty[0]&256&&t(27,r=Array.from(c.selectedMessages.values())),l.$$.dirty[0]&134217728&&t(7,n=r.some(X=>!X.unread)),l.$$.dirty[0]&134217728&&t(6,i=r.some(X=>X.unread)),l.$$.dirty[0]&134217728&&t(5,a=r.some(X=>X.starred)),l.$$.dirty[0]&134217728&&t(4,o=r.some(X=>!X.starred)),l.$$.dirty[0]&504&&t(13,f=c.params.tray=="trash"?!c.totalCount:!s&&!n&&!i&&!a&&!o)},[_,b,p,s,o,a,i,n,c,h,y,C,A,f,M,$,T,L,N,P,W,j,J,se,R,Y,re,r,oe,Z,Q,U]}class il extends le{constructor(e){super(),ne(this,e,In,Bn,te,{store:0,transparent:1,dropup:2},null,[-1,-1])}}function Zt(l){let e,t;return{c(){e=v("div"),t=B(l[4]),d(e,"class","align-self-center text-nowrap")},m(s,r){k(s,e,r),g(e,t)},p(s,r){r&16&&q(t,s[4])},d(s){s&&w(e)}}}function xt(l){let e,t;return{c(){e=v("div"),t=B(l[4]),d(e,"class","text-truncate align-self-center mx-2")},m(s,r){k(s,e,r),g(e,t)},p(s,r){r&16&&q(t,s[4])},d(s){s&&w(e)}}}function qn(l){let e,t,s,r,n,i,a,o,f,c,m,u,_,b,p,h,y,C=!l[2]&&Zt(l),A=l[2]&&xt(l);return{c(){e=v("div"),C&&C.c(),t=z(),s=v("div"),r=v("button"),n=v("i"),f=z(),A&&A.c(),c=z(),m=v("button"),u=v("i"),d(n,"class","fa fa-w fa-chevron-left"),d(n,"aria-label",i=l[3].strings.previouspage),d(r,"class","btn btn-secondary"),r.disabled=a=!l[5],d(r,"title",o=l[3].strings[l[3].message?"previousmessage":"previouspage"]),F(r,"btn-secondary",!l[1]),d(u,"class","fa fa-w fa-chevron-right"),d(u,"aria-label",_=l[3].strings.nextpage),d(m,"class","btn"),m.disabled=b=!l[6],d(m,"title",p=l[3].strings[l[3].message?"nextmessage":"nextpage"]),F(m,"btn-secondary",!l[1]),d(s,"class","btn-group d-flex flex-shrink-1"),d(s,"role","group"),F(s,"btn-group",!l[2]),d(e,"class","local-mail-paging-buttons d-flex svelte-nbwrye"),F(e,"ml-auto",!l[2])},m(M,$){k(M,e,$),C&&C.m(e,null),g(e,t),g(e,s),g(s,r),g(r,n),g(s,f),A&&A.m(s,null),g(s,c),g(s,m),g(m,u),h||(y=[K(r,"click",ke(l[9])),K(m,"click",ke(l[10]))],h=!0)},p(M,[$]){M[2]?C&&(C.d(1),C=null):C?C.p(M,$):(C=Zt(M),C.c(),C.m(e,t)),$&8&&i!==(i=M[3].strings.previouspage)&&d(n,"aria-label",i),$&32&&a!==(a=!M[5])&&(r.disabled=a),$&8&&o!==(o=M[3].strings[M[3].message?"previousmessage":"previouspage"])&&d(r,"title",o),$&2&&F(r,"btn-secondary",!M[1]),M[2]?A?A.p(M,$):(A=xt(M),A.c(),A.m(s,c)):A&&(A.d(1),A=null),$&8&&_!==(_=M[3].strings.nextpage)&&d(u,"aria-label",_),$&64&&b!==(b=!M[6])&&(m.disabled=b),$&8&&p!==(p=M[3].strings[M[3].message?"nextmessage":"nextpage"])&&d(m,"title",p),$&2&&F(m,"btn-secondary",!M[1]),$&4&&F(s,"btn-group",!M[2]),$&4&&F(e,"ml-auto",!M[2])},i:I,o:I,d(M){M&&w(e),C&&C.d(),A&&A.d(),h=!1,_e(y)}}}function Rn(l,e,t){let s,r,n,i,a,o,f=I,c=()=>(f(),f=ae(m,h=>t(3,o=h)),m);l.$$.on_destroy.push(()=>f());let{store:m}=e;c();let{transparent:u=!1}=e,{compact:_=!1}=e;const b=()=>m.navigate(i),p=()=>m.navigate(n);return l.$$set=h=>{"store"in h&&c(t(0,m=h.store)),"transparent"in h&&t(1,u=h.transparent),"compact"in h&&t(2,_=h.compact)},l.$$.update=()=>{var h;l.$$.dirty&8&&t(8,s=o.nextMessageId||!o.params.search&&(o.params.offset||0)+o.preferences.perpage<o.totalCount),l.$$.dirty&8&&t(7,r=o.prevMessageId||!o.params.search&&(o.params.offset||0)>0),l.$$.dirty&264&&t(6,n=s?o.message?{...o.params,messageid:o.nextMessageId,offset:(o.params.offset||0)+1}:{...o.params,messageid:void 0,offset:(o.params.offset||0)+o.preferences.perpage,search:o.params.search?{...o.params.search,startid:(h=o.listMessages[o.listMessages.length-1])==null?void 0:h.id,reverse:!1}:void 0}:void 0),l.$$.dirty&136&&t(5,i=r?o.message?{...o.params,messageid:o.prevMessageId,offset:Math.max(0,(o.params.offset||0)-1)}:{...o.params,messageid:void 0,offset:Math.max(0,(o.params.offset||0)-o.preferences.perpage),search:o.params.search?{...o.params.search,startid:o.listMessages[0].id,reverse:!0}:void 0}:void 0),l.$$.dirty&8&&t(4,a=o.message?o.params.search?(o.params.offset||0)+1:Me(o.strings.pagingsingle,{index:(o.messageOffset||0)+1,total:o.totalCount}):o.listMessages.length==0?"":o.params.search?Me(o.strings.pagingsearch,{first:(o.params.offset||0)+1,last:(o.params.offset||0)+o.listMessages.length}):Me(o.strings.pagingmultiple,{first:(o.params.offset||0)+1,last:(o.params.offset||0)+o.listMessages.length,total:o.totalCount}))},[m,u,_,o,a,i,n,r,s,b,p]}class al extends le{constructor(e){super(),ne(this,e,Rn,qn,te,{store:0,transparent:1,compact:2})}}function es(l){let e,t;return e=new Ee({props:{title:l[3].strings.restore,cancelText:l[3].strings.cancel,confirmText:l[3].strings.restore,handleCancel:l[5],handleConfirm:l[6],$$slots:{default:[En]},$$scope:{ctx:l}}}),{c(){G(e.$$.fragment)},m(s,r){H(e,s,r),t=!0},p(s,r){const n={};r&8&&(n.title=s[3].strings.restore),r&8&&(n.cancelText=s[3].strings.cancel),r&8&&(n.confirmText=s[3].strings.restore),r&136&&(n.$$scope={dirty:r,ctx:s}),e.$set(n)},i(s){t||(S(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function En(l){let e=l[3].strings.messagerestoreconfirm+"",t;return{c(){t=B(e)},m(s,r){k(s,t,r)},p(s,r){r&8&&e!==(e=s[3].strings.messagerestoreconfirm+"")&&q(t,e)},d(s){s&&w(t)}}}function Pn(l){let e,t,s,r,n,i,a,o,f,c=l[2]&&es(l);return{c(){e=v("button"),t=v("i"),n=z(),c&&c.c(),i=ce(),d(t,"class","fa fa-fw fa-undo"),d(e,"type","button"),d(e,"class","local-mail-action-delete btn"),e.disabled=s=!l[3].selectedMessages.size,d(e,"title",r=l[3].strings.restore),F(e,"btn-secondary",!l[1]),F(e,"disabled",!l[3].selectedMessages.size)},m(m,u){k(m,e,u),g(e,t),k(m,n,u),c&&c.m(m,u),k(m,i,u),a=!0,o||(f=K(e,"click",l[4]),o=!0)},p(m,[u]){(!a||u&8&&s!==(s=!m[3].selectedMessages.size))&&(e.disabled=s),(!a||u&8&&r!==(r=m[3].strings.restore))&&d(e,"title",r),(!a||u&2)&&F(e,"btn-secondary",!m[1]),(!a||u&8)&&F(e,"disabled",!m[3].selectedMessages.size),m[2]?c?(c.p(m,u),u&4&&S(c,1)):(c=es(m),c.c(),S(c,1),c.m(i.parentNode,i)):c&&(x(),D(c,1,1,()=>{c=null}),ee())},i(m){a||(S(c),a=!0)},o(m){D(c),a=!1},d(m){m&&w(e),m&&w(n),c&&c.d(m),m&&w(i),o=!1,f()}}}function Fn(l,e,t){let s,r=I,n=()=>(r(),r=ae(i,u=>t(3,s=u)),i);l.$$.on_destroy.push(()=>r());let{store:i}=e;n();let{transparent:a=!1}=e,o=!1;const f=()=>{t(2,o=!0)},c=()=>{t(2,o=!1)},m=()=>{t(2,o=!1),i.setDeleted(Array.from(s.selectedMessages.keys()),Ce.NotDeleted,!0)};return l.$$set=u=>{"store"in u&&n(t(0,i=u.store)),"transparent"in u&&t(1,a=u.transparent)},[i,a,o,s,f,c,m]}class ol extends le{constructor(e){super(),ne(this,e,Fn,Pn,te,{store:0,transparent:1})}}function Un(l){let e,t,s,r;return e=new rl({props:{store:l[0],transparent:!0,dropup:!0}}),s=new sl({props:{store:l[0],transparent:!0}}),{c(){G(e.$$.fragment),t=z(),G(s.$$.fragment)},m(n,i){H(e,n,i),k(n,t,i),H(s,n,i),r=!0},p(n,i){const a={};i&1&&(a.store=n[0]),e.$set(a);const o={};i&1&&(o.store=n[0]),s.$set(o)},i(n){r||(S(e.$$.fragment,n),S(s.$$.fragment,n),r=!0)},o(n){D(e.$$.fragment,n),D(s.$$.fragment,n),r=!1},d(n){O(e,n),n&&w(t),O(s,n)}}}function Gn(l){let e,t,s,r;return e=new ol({props:{store:l[0],transparent:!0}}),s=new ll({props:{store:l[0],transparent:!0}}),{c(){G(e.$$.fragment),t=z(),G(s.$$.fragment)},m(n,i){H(e,n,i),k(n,t,i),H(s,n,i),r=!0},p(n,i){const a={};i&1&&(a.store=n[0]),e.$set(a);const o={};i&1&&(o.store=n[0]),s.$set(o)},i(n){r||(S(e.$$.fragment,n),S(s.$$.fragment,n),r=!0)},o(n){D(e.$$.fragment,n),D(s.$$.fragment,n),r=!1},d(n){O(e,n),n&&w(t),O(s,n)}}}function Hn(l){let e,t,s,r,n,i,a,o,f,c,m;const u=[Gn,Un],_=[];function b(p,h){return p[4].params.tray=="trash"?0:1}return r=b(l),n=_[r]=u[r](l),a=new il({props:{store:l[0],transparent:!0,dropup:!0}}),f=new al({props:{store:l[0],transparent:!0,compact:!0}}),{c(){e=v("div"),t=v("div"),s=v("div"),n.c(),i=z(),G(a.$$.fragment),o=z(),G(f.$$.fragment),d(s,"class","w-100 d-flex justify-content-around"),d(s,"role","group"),d(t,"role","toolbar"),d(t,"class","local-mail-toolbar d-flex w-100 py-3 border-top"),Te(()=>l[5].call(t)),F(t,"position-fixed",l[3]),F(t,"position-absolute",!l[3]),F(t,"fixed-bottom",l[3]),F(t,"border-bottom",!l[3]),F(t,"bg-white",!l[3]),F(t,"bg-light",l[3]),d(e,"class","row position-relative"),ie(e,"height",l[1]+"px")},m(p,h){k(p,e,h),g(e,t),g(t,s),_[r].m(s,null),g(s,i),H(a,s,null),g(s,o),H(f,s,null),c=Ml(t,l[5].bind(t)),l[6](e),m=!0},p(p,[h]){let y=r;r=b(p),r===y?_[r].p(p,h):(x(),D(_[y],1,1,()=>{_[y]=null}),ee(),n=_[r],n?n.p(p,h):(n=_[r]=u[r](p),n.c()),S(n,1),n.m(s,i));const C={};h&1&&(C.store=p[0]),a.$set(C);const A={};h&1&&(A.store=p[0]),f.$set(A),(!m||h&8)&&F(t,"position-fixed",p[3]),(!m||h&8)&&F(t,"position-absolute",!p[3]),(!m||h&8)&&F(t,"fixed-bottom",p[3]),(!m||h&8)&&F(t,"border-bottom",!p[3]),(!m||h&8)&&F(t,"bg-white",!p[3]),(!m||h&8)&&F(t,"bg-light",p[3]),(!m||h&2)&&ie(e,"height",p[1]+"px")},i(p){m||(S(n),S(a.$$.fragment,p),S(f.$$.fragment,p),m=!0)},o(p){D(n),D(a.$$.fragment,p),D(f.$$.fragment,p),m=!1},d(p){p&&w(e),_[r].d(),O(a),O(f),c(),l[6](null)}}}function On(l,e,t){let s,r=I,n=()=>(r(),r=ae(i,u=>t(4,s=u)),i);l.$$.on_destroy.push(()=>r());let{store:i}=e;n();let a,o,f=!1;We(()=>{const u=new IntersectionObserver(_=>{for(const b of _)t(3,f=b.intersectionRatio<1&&b.boundingClientRect.top>=b.boundingClientRect.height)},{threshold:1});return u.observe(o),()=>u.disconnect()});function c(){a=this.offsetHeight,t(1,a)}function m(u){ge[u?"unshift":"push"](()=>{o=u,t(2,o)})}return l.$$set=u=>{"store"in u&&n(t(0,i=u.store))},[i,a,o,f,s,c,m]}class Kn extends le{constructor(e){super(),ne(this,e,On,Hn,te,{store:0})}}function fl(l,{from:e,to:t},s={}){const r=getComputedStyle(l),n=r.transform==="none"?"":r.transform,[i,a]=r.transformOrigin.split(" ").map(parseFloat),o=e.left+e.width*i/t.width-(t.left+i),f=e.top+e.height*a/t.height-(t.top+a),{delay:c=0,duration:m=_=>Math.sqrt(_)*120,easing:u=xs}=s;return{delay:c,duration:be(m)?m(Math.sqrt(o*o+f*f)):m,easing:u,css:(_,b)=>{const p=b*o,h=b*f,y=_+b*e.width/t.width,C=_+b*e.height/t.height;return`transform: ${n} translate(${p}px, ${h}px) scale(${y}, ${C});`}}}function Vn(l){let e,t,s,r,n,i,a;return{c(){e=v("button"),t=v("i"),d(t,"class",s="fa align-middle "+l[3]),d(e,"class","btn px-2"),d(e,"role","checkbox"),d(e,"aria-checked",r=!!l[2].selectedMessages.has(l[1].id)),d(e,"title",n=l[2].strings.select)},m(o,f){k(o,e,f),g(e,t),i||(a=K(e,"click",$l(ke(l[4]))),i=!0)},p(o,[f]){f&8&&s!==(s="fa align-middle "+o[3])&&d(t,"class",s),f&6&&r!==(r=!!o[2].selectedMessages.has(o[1].id))&&d(e,"aria-checked",r),f&4&&n!==(n=o[2].strings.select)&&d(e,"title",n)},i:I,o:I,d(o){o&&w(e),i=!1,a()}}}function Wn(l,e,t){let s,r,n=I,i=()=>(n(),n=ae(a,c=>t(2,r=c)),a);l.$$.on_destroy.push(()=>n());let{store:a}=e;i();let{message:o}=e;const f=()=>a.toggleSelected(o.id);return l.$$set=c=>{"store"in c&&i(t(0,a=c.store)),"message"in c&&t(1,o=c.message)},l.$$.update=()=>{l.$$.dirty&6&&t(3,s=r.selectedMessages.has(o.id)?"fa-check-square-o":"fa-square-o")},[a,o,r,s,f]}class ul extends le{constructor(e){super(),ne(this,e,Wn,Vn,te,{store:0,message:1})}}function Xn(l){let e,t,s,r,n,i,a,o;return{c(){e=v("button"),t=v("i"),d(t,"class",s="fa "+l[2]),d(e,"class","btn px-2"),d(e,"role","checkbox"),d(e,"aria-checked",r=l[1].starred),e.disabled=n=l[1].deleted,d(e,"title",i=l[1].deleted?l[3].strings[l[1].starred?"starred":"unstarred"]:l[3].strings[l[1].starred?"markasunstarred":"markasstarred"])},m(f,c){k(f,e,c),g(e,t),a||(o=K(e,"click",l[4]),a=!0)},p(f,[c]){c&4&&s!==(s="fa "+f[2])&&d(t,"class",s),c&2&&r!==(r=f[1].starred)&&d(e,"aria-checked",r),c&2&&n!==(n=f[1].deleted)&&(e.disabled=n),c&10&&i!==(i=f[1].deleted?f[3].strings[f[1].starred?"starred":"unstarred"]:f[3].strings[f[1].starred?"markasunstarred":"markasstarred"])&&d(e,"title",i)},i:I,o:I,d(f){f&&w(e),a=!1,o()}}}function Yn(l,e,t){let s,r,n=I,i=()=>(n(),n=ae(a,c=>t(3,r=c)),a);l.$$.on_destroy.push(()=>n());let{store:a}=e;i();let{message:o}=e;const f=()=>a.setStarred([o.id],!o.starred);return l.$$set=c=>{"store"in c&&i(t(0,a=c.store)),"message"in c&&t(1,o=c.message)},l.$$.update=()=>{l.$$.dirty&2&&t(2,s=o.starred?"fa-star text-warning":"fa-star-o")},[a,o,s,r,f]}class cl extends le{constructor(e){super(),ne(this,e,Yn,Xn,te,{store:0,message:1})}}function Jn(l){let e,t=l[1].join(", ")+"",s,r,n,i;return{c(){e=v("div"),s=B(t)},m(a,o){k(a,e,o),g(e,s),n||(i=he(r=Ge.call(null,e,l[1].join(`
`))),n=!0)},p(a,[o]){o&2&&t!==(t=a[1].join(", ")+"")&&q(s,t),r&&be(r.update)&&o&2&&r.update.call(null,a[1].join(`
`))},i:I,o:I,d(a){a&&w(e),n=!1,i()}}}function Qn(l,e,t){let s,r,n=I,i=()=>(n(),n=ae(a,f=>t(3,r=f)),a);l.$$.on_destroy.push(()=>n());let{store:a}=e;i();let{message:o}=e;return l.$$set=f=>{"store"in f&&i(t(0,a=f.store)),"message"in f&&t(2,o=f.message)},l.$$.update=()=>{l.$$.dirty&12&&t(1,s=r.params.tray=="sent"||r.params.tray=="drafts"?o.recipients.length>0?o.recipients.map(f=>f.fullname):[r.strings.norecipient]:[o.sender.fullname])},[a,s,o,r]}class tt extends le{constructor(e){super(),ne(this,e,Qn,Jn,te,{store:0,message:2})}}function ts(l){let e,t=l[2].strings.draft+"",s;return{c(){e=v("span"),s=B(t),d(e,"class","mr-2 text-danger")},m(r,n){k(r,e,n),g(e,s)},p(r,n){n&4&&t!==(t=r[2].strings.draft+"")&&q(s,t)},d(r){r&&w(e)}}}function Zn(l){let e,t,s=(l[1].subject||l[2].strings.nosubject)+"",r,n,i,a,o=l[1].draft&&ts(l);return{c(){e=v("div"),o&&o.c(),t=z(),r=B(s)},m(f,c){k(f,e,c),o&&o.m(e,null),g(e,t),g(e,r),i||(a=he(n=Ge.call(null,e,l[1].subject||l[2].strings.nosubject)),i=!0)},p(f,[c]){f[1].draft?o?o.p(f,c):(o=ts(f),o.c(),o.m(e,t)):o&&(o.d(1),o=null),c&6&&s!==(s=(f[1].subject||f[2].strings.nosubject)+"")&&q(r,s),n&&be(n.update)&&c&6&&n.update.call(null,f[1].subject||f[2].strings.nosubject)},i:I,o:I,d(f){f&&w(e),o&&o.d(),i=!1,a()}}}function xn(l,e,t){let s,r=I,n=()=>(r(),r=ae(i,o=>t(2,s=o)),i);l.$$.on_destroy.push(()=>r());let{store:i}=e;n();let{message:a}=e;return l.$$set=o=>{"store"in o&&n(t(0,i=o.store)),"message"in o&&t(1,a=o.message)},[i,a,s]}class st extends le{constructor(e){super(),ne(this,e,xn,Zn,te,{store:0,message:1})}}function ss(l,e,t){const s=l.slice();return s[3]=e[t],s}function ls(l){let e,t,s=l[2].params.courseid!=l[1].course.id&&ns(l);return{c(){s&&s.c(),e=ce()},m(r,n){s&&s.m(r,n),k(r,e,n),t=!0},p(r,n){r[2].params.courseid!=r[1].course.id?s?(s.p(r,n),n&6&&S(s,1)):(s=ns(r),s.c(),S(s,1),s.m(e.parentNode,e)):s&&(x(),D(s,1,1,()=>{s=null}),ee())},i(r){t||(S(s),t=!0)},o(r){D(s),t=!1},d(r){s&&s.d(r),r&&w(e)}}}function ns(l){let e,t;return e=new et({props:{course:l[1].course,settings:l[2].settings}}),{c(){G(e.$$.fragment)},m(s,r){H(e,s,r),t=!0},p(s,r){const n={};r&2&&(n.course=s[1].course),r&4&&(n.settings=s[2].settings),e.$set(n)},i(s){t||(S(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function rs(l){let e,t;return e=new tl({props:{label:l[3]}}),{c(){G(e.$$.fragment)},m(s,r){H(e,s,r),t=!0},p(s,r){const n={};r&2&&(n.label=s[3]),e.$set(n)},i(s){t||(S(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function is(l,e){let t,s,r,n=(e[2].params.tray!="label"||e[2].params.labelid!=e[3].id)&&rs(e);return{key:l,first:null,c(){t=ce(),n&&n.c(),s=ce(),this.first=t},m(i,a){k(i,t,a),n&&n.m(i,a),k(i,s,a),r=!0},p(i,a){e=i,e[2].params.tray!="label"||e[2].params.labelid!=e[3].id?n?(n.p(e,a),a&6&&S(n,1)):(n=rs(e),n.c(),S(n,1),n.m(s.parentNode,s)):n&&(x(),D(n,1,1,()=>{n=null}),ee())},i(i){r||(S(n),r=!0)},o(i){D(n),r=!1},d(i){i&&w(t),n&&n.d(i),i&&w(s)}}}function as(l){let e,t,s=l[2].params.courseid!=l[1].course.id&&os(l);return{c(){s&&s.c(),e=ce()},m(r,n){s&&s.m(r,n),k(r,e,n),t=!0},p(r,n){r[2].params.courseid!=r[1].course.id?s?(s.p(r,n),n&6&&S(s,1)):(s=os(r),s.c(),S(s,1),s.m(e.parentNode,e)):s&&(x(),D(s,1,1,()=>{s=null}),ee())},i(r){t||(S(s),t=!0)},o(r){D(s),t=!1},d(r){s&&s.d(r),r&&w(e)}}}function os(l){let e,t;return e=new et({props:{course:l[1].course,settings:l[2].settings}}),{c(){G(e.$$.fragment)},m(s,r){H(e,s,r),t=!0},p(s,r){const n={};r&2&&(n.course=s[1].course),r&4&&(n.settings=s[2].settings),e.$set(n)},i(s){t||(S(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function er(l){let e,t=[],s=new Map,r,n,i,a=l[2].viewSize<fe.MD&&ls(l),o=l[1].labels;const f=m=>m[3].id;for(let m=0;m<o.length;m+=1){let u=ss(l,o,m),_=f(u);s.set(_,t[m]=is(_,u))}let c=l[2].viewSize>=fe.MD&&as(l);return{c(){a&&a.c(),e=z();for(let m=0;m<t.length;m+=1)t[m].c();r=z(),c&&c.c(),n=ce()},m(m,u){a&&a.m(m,u),k(m,e,u);for(let _=0;_<t.length;_+=1)t[_]&&t[_].m(m,u);k(m,r,u),c&&c.m(m,u),k(m,n,u),i=!0},p(m,[u]){m[2].viewSize<fe.MD?a?(a.p(m,u),u&4&&S(a,1)):(a=ls(m),a.c(),S(a,1),a.m(e.parentNode,e)):a&&(x(),D(a,1,1,()=>{a=null}),ee()),u&6&&(o=m[1].labels,x(),t=we(t,u,f,1,m,o,s,r.parentNode,Ze,is,r,ss),ee()),m[2].viewSize>=fe.MD?c?(c.p(m,u),u&4&&S(c,1)):(c=as(m),c.c(),S(c,1),c.m(n.parentNode,n)):c&&(x(),D(c,1,1,()=>{c=null}),ee())},i(m){if(!i){S(a);for(let u=0;u<o.length;u+=1)S(t[u]);S(c),i=!0}},o(m){D(a);for(let u=0;u<t.length;u+=1)D(t[u]);D(c),i=!1},d(m){a&&a.d(m),m&&w(e);for(let u=0;u<t.length;u+=1)t[u].d(m);m&&w(r),c&&c.d(m),m&&w(n)}}}function tr(l,e,t){let s,r=I,n=()=>(r(),r=ae(i,o=>t(2,s=o)),i);l.$$.on_destroy.push(()=>r());let{store:i}=e;n();let{message:a}=e;return l.$$set=o=>{"store"in o&&n(t(0,i=o.store)),"message"in o&&t(1,a=o.message)},[i,a,s]}class ml extends le{constructor(e){super(),ne(this,e,tr,er,te,{store:0,message:1})}}function fs(l){let e,t,s,r,n;return{c(){e=v("span"),t=v("i"),d(t,"class",s="fa fa-fw "+(l[1].numattachments>0?"fa-paperclip":"")),d(t,"aria-hidden",!0),d(e,"class","-shrink-0 mr-2"),d(e,"title",r=l[1].numattachments>0?Me(l[2].strings.attachnumber,l[1].numattachments):""),d(e,"aria-hidden",n=l[1].numattachments==0)},m(i,a){k(i,e,a),g(e,t)},p(i,a){a&2&&s!==(s="fa fa-fw "+(i[1].numattachments>0?"fa-paperclip":""))&&d(t,"class",s),a&6&&r!==(r=i[1].numattachments>0?Me(i[2].strings.attachnumber,i[1].numattachments):"")&&d(e,"title",r),a&2&&n!==(n=i[1].numattachments==0)&&d(e,"aria-hidden",n)},d(i){i&&w(e)}}}function sr(l){let e,t=(l[1].numattachments>0||l[2].viewSize>=fe.MD)&&fs(l);return{c(){t&&t.c(),e=ce()},m(s,r){t&&t.m(s,r),k(s,e,r)},p(s,[r]){s[1].numattachments>0||s[2].viewSize>=fe.MD?t?t.p(s,r):(t=fs(s),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:I,o:I,d(s){t&&t.d(s),s&&w(e)}}}function lr(l,e,t){let s,r=I,n=()=>(r(),r=ae(i,o=>t(2,s=o)),i);l.$$.on_destroy.push(()=>r());let{store:i}=e;n();let{message:a}=e;return l.$$set=o=>{"store"in o&&n(t(0,i=o.store)),"message"in o&&t(1,a=o.message)},[i,a,s]}class dl extends le{constructor(e){super(),ne(this,e,lr,sr,te,{store:0,message:1})}}function nr(l){let e,t=l[0].shorttime+"",s,r;return{c(){e=v("span"),s=B(t),d(e,"class","local-mail-list-message-time d-shrink-0 text-nowrap text-right svelte-phmq8k"),d(e,"title",r=l[0].fulltime),F(e,"local-mail-list-message-time-md",l[2].viewSize>=fe.MD)},m(n,i){k(n,e,i),g(e,s)},p(n,[i]){i&1&&t!==(t=n[0].shorttime+"")&&q(s,t),i&1&&r!==(r=n[0].fulltime)&&d(e,"title",r),i&4&&F(e,"local-mail-list-message-time-md",n[2].viewSize>=fe.MD)},i:I,o:I,d(n){n&&w(e)}}}function rr(l,e,t){let s,r=I,n=()=>(r(),r=ae(a,o=>t(2,s=o)),a);l.$$.on_destroy.push(()=>r());let{message:i}=e,{store:a}=e;return n(),l.$$set=o=>{"message"in o&&t(0,i=o.message),"store"in o&&n(t(1,a=o.store))},[i,a,s]}class _l extends le{constructor(e){super(),ne(this,e,rr,nr,te,{message:0,store:1})}}function us(l){let e,t,s=l[1].strings.nomessagesfound+"",r,n,i,a=l[1].totalCount>0&&cs(l);return{c(){e=v("div"),t=v("div"),r=B(s),n=z(),a&&a.c(),d(e,"class","alert alert-info")},m(o,f){k(o,e,f),g(e,t),g(t,r),g(e,n),a&&a.m(e,null)},p(o,f){f&2&&s!==(s=o[1].strings.nomessagesfound+"")&&q(r,s),o[1].totalCount>0?a?a.p(o,f):(a=cs(o),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},i(o){o&&(i||Te(()=>{i=xe(e,Fe,{delay:400}),i.start()}))},o:I,d(o){o&&w(e),a&&a.d()}}}function cs(l){let e,t=l[1].strings.showrecentmessages+"",s,r,n,i;return{c(){e=v("a"),s=B(t),d(e,"class","btn btn-info text-white mt-3"),d(e,"href",r=$e(l[2]))},m(a,o){k(a,e,o),g(e,s),n||(i=K(e,"click",ke(l[3])),n=!0)},p(a,o){o&2&&t!==(t=a[1].strings.showrecentmessages+"")&&q(s,t),o&4&&r!==(r=$e(a[2]))&&d(e,"href",r)},d(a){a&&w(e),n=!1,i()}}}function ir(l){let e,t=!l[1].listMessages.length&&us(l);return{c(){t&&t.c(),e=ce()},m(s,r){t&&t.m(s,r),k(s,e,r)},p(s,[r]){s[1].listMessages.length?t&&(t.d(1),t=null):t?(t.p(s,r),r&2&&S(t,1)):(t=us(s),t.c(),S(t,1),t.m(e.parentNode,e))},i(s){S(t)},o:I,d(s){t&&t.d(s),s&&w(e)}}}function ar(l,e,t){let s,r,n=I,i=()=>(n(),n=ae(a,f=>t(1,r=f)),a);l.$$.on_destroy.push(()=>n());let{store:a}=e;i();const o=()=>a.navigate(s);return l.$$set=f=>{"store"in f&&i(t(0,a=f.store))},l.$$.update=()=>{l.$$.dirty&2&&t(2,s={tray:r.params.tray,courseid:r.params.courseid,labelid:r.params.labelid})},[a,r,s,o]}class or extends le{constructor(e){super(),ne(this,e,ar,ir,te,{store:0})}}function ms(l,e,t){const s=l.slice();return s[4]=e[t],s[6]=t,s}function fr(l){let e,t,s,r,n,i,a,o,f,c,m,u,_,b,p,h,y,C,A,M,$;return t=new ul({props:{store:l[0],message:l[4]}}),i=new tt({props:{store:l[0],message:l[4]}}),o=new dl({props:{store:l[0],message:l[4]}}),m=new _l({props:{store:l[0],message:l[4]}}),p=new st({props:{store:l[0],message:l[4]}}),y=new cl({props:{store:l[0],message:l[4]}}),M=new ml({props:{store:l[0],message:l[4]}}),{c(){e=v("div"),G(t.$$.fragment),s=z(),r=v("div"),n=v("div"),G(i.$$.fragment),a=z(),G(o.$$.fragment),f=z(),c=v("div"),G(m.$$.fragment),u=z(),_=v("div"),b=v("div"),G(p.$$.fragment),h=z(),G(y.$$.fragment),C=z(),A=v("div"),G(M.$$.fragment),d(c,"class","ml-auto mr-2"),d(n,"class","d-flex mt-2"),d(b,"class","d-flex w-100 d-shrink-1 my-2 mr-2"),ie(b,"min-width","0"),d(_,"class","d-flex"),d(A,"class","d-flex flex-wrap ml-n2 mr-2"),d(r,"class","flex-shrink-1 w-100 ml-1"),ie(r,"min-width","0"),d(e,"class","d-flex align-items-start pt-1 pb-2 pl-1 pr-2")},m(T,L){k(T,e,L),H(t,e,null),g(e,s),g(e,r),g(r,n),H(i,n,null),g(n,a),H(o,n,null),g(n,f),g(n,c),H(m,c,null),g(r,u),g(r,_),g(_,b),H(p,b,null),g(_,h),H(y,_,null),g(r,C),g(r,A),H(M,A,null),$=!0},p(T,L){const N={};L&1&&(N.store=T[0]),L&2&&(N.message=T[4]),t.$set(N);const P={};L&1&&(P.store=T[0]),L&2&&(P.message=T[4]),i.$set(P);const W={};L&1&&(W.store=T[0]),L&2&&(W.message=T[4]),o.$set(W);const j={};L&1&&(j.store=T[0]),L&2&&(j.message=T[4]),m.$set(j);const J={};L&1&&(J.store=T[0]),L&2&&(J.message=T[4]),p.$set(J);const se={};L&1&&(se.store=T[0]),L&2&&(se.message=T[4]),y.$set(se);const R={};L&1&&(R.store=T[0]),L&2&&(R.message=T[4]),M.$set(R)},i(T){$||(S(t.$$.fragment,T),S(i.$$.fragment,T),S(o.$$.fragment,T),S(m.$$.fragment,T),S(p.$$.fragment,T),S(y.$$.fragment,T),S(M.$$.fragment,T),$=!0)},o(T){D(t.$$.fragment,T),D(i.$$.fragment,T),D(o.$$.fragment,T),D(m.$$.fragment,T),D(p.$$.fragment,T),D(y.$$.fragment,T),D(M.$$.fragment,T),$=!1},d(T){T&&w(e),O(t),O(i),O(o),O(m),O(p),O(y),O(M)}}}function ur(l){let e,t,s,r,n,i,a,o,f,c,m,u,_,b,p,h,y,C,A;return t=new ul({props:{store:l[0],message:l[4]}}),r=new cl({props:{store:l[0],message:l[4]}}),o=new tt({props:{store:l[0],message:l[4]}}),m=new st({props:{store:l[0],message:l[4]}}),b=new ml({props:{store:l[0],message:l[4]}}),h=new dl({props:{store:l[0],message:l[4]}}),C=new _l({props:{store:l[0],message:l[4]}}),{c(){e=v("div"),G(t.$$.fragment),s=z(),G(r.$$.fragment),n=z(),i=v("div"),a=v("div"),G(o.$$.fragment),f=z(),c=v("div"),G(m.$$.fragment),u=z(),_=v("div"),G(b.$$.fragment),p=z(),G(h.$$.fragment),y=z(),G(C.$$.fragment),d(a,"class","flex-grow-1 mx-2"),ie(a,"width","25%"),ie(a,"min-width","0"),d(_,"class","d-flex text-truncate flex-shrink-0 justify-content-end mb-n2 ml-auto"),ie(_,"max-width","80%"),d(c,"class","flex-grow-1 d-flex my-2 mx-2"),ie(c,"width","75%"),ie(c,"min-width","0"),d(i,"class","d-flex w-100 flex-grow-1 align-items-center"),ie(i,"min-width","0"),d(e,"class","d-flex align-items-center pl-1 pr-3")},m(M,$){k(M,e,$),H(t,e,null),g(e,s),H(r,e,null),g(e,n),g(e,i),g(i,a),H(o,a,null),g(i,f),g(i,c),H(m,c,null),g(c,u),g(c,_),H(b,_,null),g(e,p),H(h,e,null),g(e,y),H(C,e,null),A=!0},p(M,$){const T={};$&1&&(T.store=M[0]),$&2&&(T.message=M[4]),t.$set(T);const L={};$&1&&(L.store=M[0]),$&2&&(L.message=M[4]),r.$set(L);const N={};$&1&&(N.store=M[0]),$&2&&(N.message=M[4]),o.$set(N);const P={};$&1&&(P.store=M[0]),$&2&&(P.message=M[4]),m.$set(P);const W={};$&1&&(W.store=M[0]),$&2&&(W.message=M[4]),b.$set(W);const j={};$&1&&(j.store=M[0]),$&2&&(j.message=M[4]),h.$set(j);const J={};$&1&&(J.store=M[0]),$&2&&(J.message=M[4]),C.$set(J)},i(M){A||(S(t.$$.fragment,M),S(r.$$.fragment,M),S(o.$$.fragment,M),S(m.$$.fragment,M),S(b.$$.fragment,M),S(h.$$.fragment,M),S(C.$$.fragment,M),A=!0)},o(M){D(t.$$.fragment,M),D(r.$$.fragment,M),D(o.$$.fragment,M),D(m.$$.fragment,M),D(b.$$.fragment,M),D(h.$$.fragment,M),D(C.$$.fragment,M),A=!1},d(M){M&&w(e),O(t),O(r),O(o),O(m),O(b),O(h),O(C)}}}function ds(l,e){let t,s,r,n,i,a,o,f=I,c,m,u;const _=[ur,fr],b=[];function p(h,y){return h[1].viewSize>=fe.MD?0:1}return s=p(e),r=b[s]=_[s](e),{key:l,first:null,c(){t=v("a"),r.c(),d(t,"class","local-mail-list-message list-group-item list-group-item-action p-0 svelte-unh3d4"),d(t,"href",n=e[4].draft?Oe(e[4].id):$e(e[2](e[4],e[6]))),F(t,"list-group-item-primary",e[1].selectedMessages.has(e[4].id)),F(t,"list-group-item-secondary",!e[4].unread&&!e[1].selectedMessages.has(e[4].id)),F(t,"font-weight-bold",e[4].unread),this.first=t},m(h,y){k(h,t,y),b[s].m(t,null),c=!0,m||(u=K(t,"click",function(){be(e[3](e[4],e[6]))&&e[3](e[4],e[6]).apply(this,arguments)}),m=!0)},p(h,y){e=h;let C=s;s=p(e),s===C?b[s].p(e,y):(x(),D(b[C],1,1,()=>{b[C]=null}),ee(),r=b[s],r?r.p(e,y):(r=b[s]=_[s](e),r.c()),S(r,1),r.m(t,null)),(!c||y&2&&n!==(n=e[4].draft?Oe(e[4].id):$e(e[2](e[4],e[6]))))&&d(t,"href",n),(!c||y&2)&&F(t,"list-group-item-primary",e[1].selectedMessages.has(e[4].id)),(!c||y&2)&&F(t,"list-group-item-secondary",!e[4].unread&&!e[1].selectedMessages.has(e[4].id)),(!c||y&2)&&F(t,"font-weight-bold",e[4].unread)},r(){o=t.getBoundingClientRect()},f(){Ws(t),f(),Xs(t,o)},a(){f(),f=Ys(t,o,fl,{delay:400,duration:400})},i(h){c||(S(r),h&&Te(()=>{c&&(a&&a.end(1),i=xe(t,Fe,{delay:400}),i.start())}),c=!0)},o(h){D(r),i&&i.invalidate(),h&&(a=Js(t,Fe,{duration:400})),c=!1},d(h){h&&w(t),b[s].d(),h&&a&&a.end(),m=!1,u()}}}function _s(l){let e,t=[],s=new Map,r,n,i,a=l[1].listMessages;const o=f=>f[4].id;for(let f=0;f<a.length;f+=1){let c=ms(l,a,f),m=o(c);s.set(m,t[f]=ds(m,c))}return n=new or({props:{store:l[0]}}),{c(){e=v("div");for(let f=0;f<t.length;f+=1)t[f].c();r=z(),G(n.$$.fragment),d(e,"class","list-group")},m(f,c){k(f,e,c);for(let m=0;m<t.length;m+=1)t[m]&&t[m].m(e,null);g(e,r),H(n,e,null),i=!0},p(f,c){if(c&15){a=f[1].listMessages,x();for(let u=0;u<t.length;u+=1)t[u].r();t=we(t,c,o,1,f,a,s,e,Vs,ds,r,ms);for(let u=0;u<t.length;u+=1)t[u].a();ee()}const m={};c&1&&(m.store=f[0]),n.$set(m)},i(f){if(!i){for(let c=0;c<a.length;c+=1)S(t[c]);S(n.$$.fragment,f),i=!0}},o(f){for(let c=0;c<t.length;c+=1)D(t[c]);D(n.$$.fragment,f),i=!1},d(f){f&&w(e);for(let c=0;c<t.length;c+=1)t[c].d();O(n)}}}function cr(l){let e=l[1].navigationId,t,s,r=_s(l);return{c(){r.c(),t=ce()},m(n,i){r.m(n,i),k(n,t,i),s=!0},p(n,[i]){i&2&&te(e,e=n[1].navigationId)?(x(),D(r,1,1,I),ee(),r=_s(n),r.c(),S(r,1),r.m(t.parentNode,t)):r.p(n,i)},i(n){s||(S(r),s=!0)},o(n){D(r),s=!1},d(n){n&&w(t),r.d(n)}}}function mr(l,e,t){let s,r=I,n=()=>(r(),r=ae(i,f=>t(1,s=f)),i);l.$$.on_destroy.push(()=>r());let{store:i}=e;n();const a=(f,c)=>({...s.params,messageid:f.id,offset:(s.params.offset||0)+c}),o=(f,c)=>m=>{f.draft||(m.preventDefault(),i.navigate(a(f,c)))};return l.$$set=f=>{"store"in f&&n(t(0,i=f.store))},[i,s,a,o]}class dr extends le{constructor(e){super(),ne(this,e,mr,cr,te,{store:0})}}function gs(l,e,t){const s=l.slice();return s[7]=e[t],s}function ps(l){let e,t=l[7]+"",s,r;return{c(){e=v("option"),s=B(t),e.__value=r=l[7],e.value=e.__value},m(n,i){k(n,e,i),g(e,s)},p(n,i){i&8&&t!==(t=n[7]+"")&&q(s,t),i&8&&r!==(r=n[7])&&(e.__value=r,e.value=e.__value)},d(n){n&&w(e)}}}function _r(l){let e,t,s,r=l[1].strings.messagesperpage+"",n,i,a,o,f,c,m=l[3],u=[];for(let _=0;_<m.length;_+=1)u[_]=ps(gs(l,m,_));return{c(){e=v("dov"),t=v("div"),s=v("label"),n=B(r),i=B(":"),a=z(),o=v("select");for(let _=0;_<u.length;_+=1)u[_].c();d(s,"for","local-mail-perpage-select"),d(o,"id","local-mail-perpage-select"),d(o,"class","custom-select"),l[2]===void 0&&Te(()=>l[4].call(o)),d(t,"class","form-group"),d(e,"class","form-inline justify-content-end mt-3")},m(_,b){k(_,e,b),g(e,t),g(t,s),g(s,n),g(s,i),g(t,a),g(t,o);for(let p=0;p<u.length;p+=1)u[p]&&u[p].m(o,null);nt(o,l[2],!0),f||(c=[K(o,"change",l[4]),K(o,"change",l[5])],f=!0)},p(_,[b]){if(b&2&&r!==(r=_[1].strings.messagesperpage+"")&&q(n,r),b&8){m=_[3];let p;for(p=0;p<m.length;p+=1){const h=gs(_,m,p);u[p]?u[p].p(h,b):(u[p]=ps(h),u[p].c(),u[p].m(o,null))}for(;p<u.length;p+=1)u[p].d(1);u.length=m.length}b&12&&nt(o,_[2])},i:I,o:I,d(_){_&&w(e),Ue(u,_),f=!1,_e(c)}}}function gr(l,e,t){let s,r,n=I,i=()=>(n(),n=ae(a,u=>t(1,r=u)),a);l.$$.on_destroy.push(()=>n());let{store:a}=e;i();const o=[5,10,20,50,100];let f=r.preferences.perpage;function c(){f=Sl(this),t(2,f),t(3,s),t(1,r)}const m=()=>a.setPerPage(f);return l.$$set=u=>{"store"in u&&i(t(0,a=u.store))},l.$$.update=()=>{l.$$.dirty&2&&t(3,s=o.includes(r.preferences.perpage)?o:o.concat([r.preferences.perpage]).sort((u,_)=>u-_))},[a,r,f,s,c,m]}class pr extends le{constructor(e){super(),ne(this,e,gr,_r,te,{store:0})}}function br(l){let e,t,s,r=l[9].strings.from+"",n,i,a,o,f,c,m,u=l[9].strings.to+"",_,b,p,h,y,C,A,M=l[9].strings.filterbydate+"",$,T,L,N,P,W,j,J,se,R,Y=l[9].strings.searchbyunread+"",re,oe,Z,Q,U,X,me=l[9].strings.searchbyattach+"",pe,E,V,ue,Se,Le,De;return{c(){e=v("div"),t=v("div"),s=v("label"),n=B(r),i=z(),a=v("div"),o=v("input"),f=z(),c=v("div"),m=v("label"),_=B(u),b=z(),p=v("div"),h=v("input"),y=z(),C=v("div"),A=v("label"),$=B(M),T=z(),L=v("div"),N=v("input"),P=z(),W=v("div"),j=v("div"),J=v("input"),se=z(),R=v("label"),re=B(Y),oe=z(),Z=v("div"),Q=v("input"),U=z(),X=v("label"),pe=B(me),E=z(),V=v("input"),d(s,"for","local-mail-search-input-sendername"),d(s,"class","col-3 col-form-label"),d(o,"type","text"),d(o,"class","form-control"),d(o,"id","local-mail-search-input-sendername"),d(a,"class","col-9"),d(t,"class","form-group row"),d(m,"for","local-mail-search-input-recipientname"),d(m,"class","col-3 col-form-label"),d(h,"type","text"),d(h,"class","form-control"),d(h,"id","local-mail-search-input-recipientname"),d(p,"class","col-9"),d(c,"class","form-group row"),d(A,"for","local-mail-search-input-maxdate"),d(A,"class","col-3 col-form-label"),d(N,"type","date"),d(N,"class","form-control"),d(N,"id","local-mail-search-input-maxdate"),d(N,"max",l[10]),N.value=l[8],d(L,"class","col-9"),d(C,"class","form-group row"),d(J,"class","form-check-input"),d(J,"type","checkbox"),d(J,"id","local-mail-search-input-unread"),d(R,"class","form-check-label"),d(R,"for","local-mail-search-input-unread"),d(j,"class","form-check flex-grow-1"),d(Q,"class","form-check-input"),d(Q,"type","checkbox"),d(Q,"id","local-mail-search-input-withfilesonly"),d(X,"class","form-check-label"),d(X,"for","local-mail-search-input-withfilesonly"),d(Z,"class","form-check flex-grow-1"),d(V,"type","submit"),V.disabled=ue=!l[6],d(V,"class","btn btn-primary px-3 ml-auto"),V.value=Se=l[9].strings.search,d(W,"class","d-flex flex-wrap align-items-center"),ie(W,"column-gap","2rem"),ie(W,"row-gap","1rem"),d(e,"class","dropdown-menu dropdown-menu-left show p-3 w-100"),ie(e,"min-width","18rem")},m(ye,de){k(ye,e,de),g(e,t),g(t,s),g(s,n),g(t,i),g(t,a),g(a,o),ve(o,l[0]),l[15](o),g(e,f),g(e,c),g(c,m),g(m,_),g(c,b),g(c,p),g(p,h),ve(h,l[1]),g(e,y),g(e,C),g(C,A),g(A,$),g(C,T),g(C,L),g(L,N),g(e,P),g(e,W),g(W,j),g(j,J),J.checked=l[2],g(j,se),g(j,R),g(R,re),g(W,oe),g(W,Z),g(Z,Q),Q.checked=l[3],g(Z,U),g(Z,X),g(X,pe),g(W,E),g(W,V),Le||(De=[K(o,"input",l[14]),K(h,"input",l[16]),K(N,"input",l[11]),K(J,"change",l[17]),K(Q,"change",l[18]),K(V,"click",ke(function(){be(l[5])&&l[5].apply(this,arguments)}))],Le=!0)},p(ye,[de]){l=ye,de&512&&r!==(r=l[9].strings.from+"")&&q(n,r),de&1&&o.value!==l[0]&&ve(o,l[0]),de&512&&u!==(u=l[9].strings.to+"")&&q(_,u),de&2&&h.value!==l[1]&&ve(h,l[1]),de&512&&M!==(M=l[9].strings.filterbydate+"")&&q($,M),de&256&&(N.value=l[8]),de&4&&(J.checked=l[2]),de&512&&Y!==(Y=l[9].strings.searchbyunread+"")&&q(re,Y),de&8&&(Q.checked=l[3]),de&512&&me!==(me=l[9].strings.searchbyattach+"")&&q(pe,me),de&64&&ue!==(ue=!l[6])&&(V.disabled=ue),de&512&&Se!==(Se=l[9].strings.search)&&(V.value=Se)},i:I,o:I,d(ye){ye&&w(e),l[15](null),Le=!1,_e(De)}}}function hr(l,e,t){let s,r,n=I,i=()=>(n(),n=ae(a,N=>t(9,r=N)),a);l.$$.on_destroy.push(()=>n());let{store:a}=e;i();let{sendername:o=""}=e,{recipientname:f=""}=e,{unread:c=!1}=e,{withfilesonly:m=!1}=e,{maxtime:u=0}=e,{submit:_}=e,{submitEnabled:b}=e;function p(){h.focus()}let h,y=rt(Math.floor(new Date().getTime()/1e3));const C=N=>{t(12,u=jl(N.target.value))};function A(){o=this.value,t(0,o)}function M(N){ge[N?"unshift":"push"](()=>{h=N,t(7,h)})}function $(){f=this.value,t(1,f)}function T(){c=this.checked,t(2,c)}function L(){m=this.checked,t(3,m)}return l.$$set=N=>{"store"in N&&i(t(4,a=N.store)),"sendername"in N&&t(0,o=N.sendername),"recipientname"in N&&t(1,f=N.recipientname),"unread"in N&&t(2,c=N.unread),"withfilesonly"in N&&t(3,m=N.withfilesonly),"maxtime"in N&&t(12,u=N.maxtime),"submit"in N&&t(5,_=N.submit),"submitEnabled"in N&&t(6,b=N.submitEnabled)},l.$$.update=()=>{l.$$.dirty&4096&&t(8,s=rt(u))},[o,f,c,m,a,_,b,h,s,r,y,C,u,p,A,M,$,T,L]}class vr extends le{constructor(e){super(),ne(this,e,hr,br,te,{store:4,sendername:0,recipientname:1,unread:2,withfilesonly:3,maxtime:12,submit:5,submitEnabled:6,focus:13})}get focus(){return this.$$.ctx[13]}}const{Boolean:kr}=Xe;function bs(l,e,t){const s=l.slice();return s[14]=e[t],s[16]=t,s}function hs(l){let e,t,s,r=l[4],n=[];for(let c=0;c<r.length;c+=1)n[c]=vs(bs(l,r,c));const i=c=>D(n[c],1,1,()=>{n[c]=null});function a(c,m){if(c[5])return Mr;if(!c[4].length)return yr}let o=a(l),f=o&&o(l);return{c(){e=v("div");for(let c=0;c<n.length;c+=1)n[c].c();t=z(),f&&f.c(),d(e,"class","dropdown-menu dropdown-menu-left overflow-hidden show p-0 w-100"),ie(e,"min-width","18rem")},m(c,m){k(c,e,m);for(let u=0;u<n.length;u+=1)n[u]&&n[u].m(e,null);g(e,t),f&&f.m(e,null),s=!0},p(c,m){if(m&401){r=c[4];let u;for(u=0;u<r.length;u+=1){const _=bs(c,r,u);n[u]?(n[u].p(_,m),S(n[u],1)):(n[u]=vs(_),n[u].c(),S(n[u],1),n[u].m(e,t))}for(x(),u=r.length;u<n.length;u+=1)i(u);ee()}o===(o=a(c))&&f?f.p(c,m):(f&&f.d(1),f=o&&o(c),f&&(f.c(),f.m(e,null)))},i(c){if(!s){for(let m=0;m<r.length;m+=1)S(n[m]);s=!0}},o(c){n=n.filter(kr);for(let m=0;m<n.length;m+=1)D(n[m]);s=!1},d(c){c&&w(e),Ue(n,c),f&&f.d()}}}function wr(l){let e;return{c(){e=v("div"),d(e,"class","dropdown-divider my-0")},m(t,s){k(t,e,s)},d(t){t&&w(e)}}}function vs(l){let e,t,s,r,n,i,a,o,f=l[14].shorttime+"",c,m,u,_,b,p,h=l[16]>0&&wr();return s=new st({props:{store:l[0],message:l[14]}}),i=new tt({props:{store:l[0],message:l[14]}}),{c(){h&&h.c(),e=z(),t=v("a"),G(s.$$.fragment),r=z(),n=v("div"),G(i.$$.fragment),a=z(),o=v("div"),c=B(f),d(o,"title",m=l[14].fulltime),d(o,"class","ml-auto"),d(n,"class","local-mail-incremental-search-muted d-flex svelte-sdeam0"),d(t,"class","dropdown-item local-mail-incremental-search-item"),d(t,"href",u=l[14].draft?Oe(l[14].id):$e(l[7](l[14],l[16]))),F(t,"font-weight-bold",l[14].unread)},m(y,C){h&&h.m(y,C),k(y,e,C),k(y,t,C),H(s,t,null),g(t,r),g(t,n),H(i,n,null),g(n,a),g(n,o),g(o,c),_=!0,b||(p=K(t,"click",function(){be(l[8](l[14],l[16]))&&l[8](l[14],l[16]).apply(this,arguments)}),b=!0)},p(y,C){l=y;const A={};C&1&&(A.store=l[0]),C&16&&(A.message=l[14]),s.$set(A);const M={};C&1&&(M.store=l[0]),C&16&&(M.message=l[14]),i.$set(M),(!_||C&16)&&f!==(f=l[14].shorttime+"")&&q(c,f),(!_||C&16&&m!==(m=l[14].fulltime))&&d(o,"title",m),(!_||C&144&&u!==(u=l[14].draft?Oe(l[14].id):$e(l[7](l[14],l[16]))))&&d(t,"href",u),(!_||C&16)&&F(t,"font-weight-bold",l[14].unread)},i(y){_||(S(s.$$.fragment,y),S(i.$$.fragment,y),_=!0)},o(y){D(s.$$.fragment,y),D(i.$$.fragment,y),_=!1},d(y){h&&h.d(y),y&&w(e),y&&w(t),O(s),O(i),b=!1,p()}}}function yr(l){let e,t=l[3].strings.nomessagesfound+"",s;return{c(){e=v("div"),s=B(t),d(e,"class","px-4 py-2 text-danger")},m(r,n){k(r,e,n),g(e,s)},p(r,n){n&8&&t!==(t=r[3].strings.nomessagesfound+"")&&q(s,t)},d(r){r&&w(e)}}}function Mr(l){let e,t,s,r=l[3].strings.searchallmessages+"",n,i,a,o;return{c(){e=v("div"),t=z(),s=v("a"),n=B(r),d(e,"class","dropdown-divider my-0"),d(s,"class","dropdown-item py-2"),d(s,"href",i=$e(l[6]))},m(f,c){k(f,e,c),k(f,t,c),k(f,s,c),g(s,n),a||(o=K(s,"click",ke(l[12])),a=!0)},p(f,c){c&8&&r!==(r=f[3].strings.searchallmessages+"")&&q(n,r),c&64&&i!==(i=$e(f[6]))&&d(s,"href",i)},d(f){f&&w(e),f&&w(t),f&&w(s),a=!1,o()}}}function $r(l){let e,t,s=l[1]&&l[4]!=null&&hs(l);return{c(){s&&s.c(),e=ce()},m(r,n){s&&s.m(r,n),k(r,e,n),t=!0},p(r,[n]){r[1]&&r[4]!=null?s?(s.p(r,n),n&18&&S(s,1)):(s=hs(r),s.c(),S(s,1),s.m(e.parentNode,e)):s&&(x(),D(s,1,1,()=>{s=null}),ee())},i(r){t||(S(s),t=!0)},o(r){D(s),t=!1},d(r){s&&s.d(r),r&&w(e)}}}const Qe=10,Sr=500;function Cr(l,e,t){let s,r,n,i=I,a=()=>(i(),i=ae(o,A=>t(3,n=A)),o);l.$$.on_destroy.push(()=>i());let{store:o}=e;a();let{enabled:f}=e,{content:c}=e,{loading:m=!1}=e,{handleClick:u}=e,_,b,p=!1;const h=async A=>{t(9,m=!0),window.clearTimeout(_),t(11,_=window.setTimeout(async()=>{const M=n.params,T={methodname:"search_messages",query:{courseid:M.courseid,labelid:M.tray=="label"?M.labelid:void 0,draft:M.tray=="drafts"?!0:M.tray=="sent"?!1:void 0,roles:M.tray=="inbox"?["to","cc","bcc"]:M.tray=="sent"?["from"]:void 0,starred:M.tray=="starred"?!0:void 0,deleted:M.tray=="trash",content:A.trim(),stopid:n.incrementalSearchStopId},limit:Qe+1};let L;try{L=await Zs([T])}catch(N){o.setError(N),t(9,m=!1),t(4,b=void 0);return}t(9,m=!1),t(4,b=L[0]),t(5,p=b.length>Qe||!!n.incrementalSearchStopId),t(4,b=b.slice(0,Qe))},Sr))},y=(A,M)=>$=>{A.draft||($.preventDefault(),u(s(A,M)))};Ks(()=>{window.clearTimeout(_)});const C=()=>u(r);return l.$$set=A=>{"store"in A&&a(t(0,o=A.store)),"enabled"in A&&t(1,f=A.enabled),"content"in A&&t(10,c=A.content),"loading"in A&&t(9,m=A.loading),"handleClick"in A&&t(2,u=A.handleClick)},l.$$.update=()=>{l.$$.dirty&3074&&(f?h(c):(t(4,b=void 0),t(9,m=!1),window.clearTimeout(_))),l.$$.dirty&1032&&t(7,s=(A,M)=>({...n.params,messageid:A.id,offset:M,search:{content:c.trim()}})),l.$$.dirty&1032&&t(6,r={...n.params,messageid:void 0,offset:0,search:{content:c.trim()}})},[o,f,u,n,b,p,r,s,y,m,c,_,C]}class Tr extends le{constructor(e){super(),ne(this,e,Cr,$r,te,{store:0,enabled:1,content:10,loading:9,handleClick:2})}}function ks(l,e,t){const s=l.slice();return s[35]=e[t].label,s[36]=e[t].value,s[38]=t,s}function zr(l){let e,t,s,r=l[15],n=[];for(let i=0;i<r.length;i+=1)n[i]=ys(ks(l,r,i));return{c(){e=v("button");for(let i=0;i<n.length;i+=1)n[i].c();d(e,"type","button"),d(e,"class","alert-primary form-control text-left text-truncate"),ie(e,"padding-left","2.5rem"),ie(e,"padding-right","5rem")},m(i,a){k(i,e,a);for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(e,null);t||(s=K(e,"click",l[16]),t=!0)},p(i,a){if(a[0]&32768){r=i[15];let o;for(o=0;o<r.length;o+=1){const f=ks(i,r,o);n[o]?n[o].p(f,a):(n[o]=ys(f),n[o].c(),n[o].m(e,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=r.length}},d(i){i&&w(e),Ue(n,i),t=!1,s()}}}function Lr(l){let e,t,s,r,n;return{c(){e=v("input"),d(e,"type","text"),d(e,"class","form-control"),ie(e,"padding-left","2.5rem"),ie(e,"padding-right","5rem"),d(e,"placeholder",t=l[7].strings.search),d(e,"aria-label",s=l[7].strings.search),d(e,"autocomplete","off")},m(i,a){k(i,e,a),ve(e,l[1]),l[26](e),r||(n=[K(e,"input",l[25]),K(e,"keypress",l[21])],r=!0)},p(i,a){a[0]&128&&t!==(t=i[7].strings.search)&&d(e,"placeholder",t),a[0]&128&&s!==(s=i[7].strings.search)&&d(e,"aria-label",s),a[0]&2&&e.value!==i[1]&&ve(e,i[1])},d(i){i&&w(e),l[26](null),r=!1,_e(n)}}}function Dr(l){let e;return{c(){e=v("span"),e.textContent=", ",d(e,"class","dimmed_text")},m(t,s){k(t,e,s)},d(t){t&&w(e)}}}function Ar(l){let e,t=l[36]+"",s,r=l[35]&&ws(l);return{c(){r&&r.c(),e=z(),s=B(t)},m(n,i){r&&r.m(n,i),k(n,e,i),k(n,s,i)},p(n,i){n[35]?r?r.p(n,i):(r=ws(n),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null),i[0]&32768&&t!==(t=n[36]+"")&&q(s,t)},d(n){r&&r.d(n),n&&w(e),n&&w(s)}}}function Nr(l){let e,t=l[35]+"",s;return{c(){e=v("span"),s=B(t),d(e,"class","dimmed_text")},m(r,n){k(r,e,n),g(e,s)},p(r,n){n[0]&32768&&t!==(t=r[35]+"")&&q(s,t)},d(r){r&&w(e)}}}function ws(l){let e,t=l[35]+"",s,r;return{c(){e=v("span"),s=B(t),r=B(":"),d(e,"class","dimmed_text")},m(n,i){k(n,e,i),g(e,s),g(e,r)},p(n,i){i[0]&32768&&t!==(t=n[35]+"")&&q(s,t)},d(n){n&&w(e)}}}function ys(l){let e,t,s=l[38]>0&&Dr();function r(a,o){return a[36]===!0?Nr:Ar}let n=r(l),i=n(l);return{c(){s&&s.c(),e=z(),i.c(),t=ce()},m(a,o){s&&s.m(a,o),k(a,e,o),i.m(a,o),k(a,t,o)},p(a,o){n===(n=r(a))&&i?i.p(a,o):(i.d(1),i=n(a),i&&(i.c(),i.m(t.parentNode,t)))},d(a){s&&s.d(a),a&&w(e),i.d(a),a&&w(t)}}}function Ms(l){let e,t,s,r,n;return{c(){e=v("button"),t=v("i"),d(t,"class","fa fa-fw fa-times"),d(t,"aria-hidden","true"),d(e,"type","button"),d(e,"class","btn px-0"),d(e,"title",s=l[7].strings.cancel),ie(e,"width","2.5rem")},m(i,a){k(i,e,a),g(e,t),r||(n=K(e,"click",ke(l[19])),r=!0)},p(i,a){a[0]&128&&s!==(s=i[7].strings.cancel)&&d(e,"title",s)},d(i){i&&w(e),r=!1,n()}}}function $s(l){let e,t,s,r,n,i,a;function o(b){l[28](b)}function f(b){l[29](b)}function c(b){l[30](b)}function m(b){l[31](b)}function u(b){l[32](b)}let _={store:l[0],submit:l[20],submitEnabled:l[13]};return l[2]!==void 0&&(_.sendername=l[2]),l[3]!==void 0&&(_.recipientname=l[3]),l[4]!==void 0&&(_.unread=l[4]),l[5]!==void 0&&(_.withfilesonly=l[5]),l[6]!==void 0&&(_.maxtime=l[6]),e=new vr({props:_}),l[27](e),ge.push(()=>Ne(e,"sendername",o)),ge.push(()=>Ne(e,"recipientname",f)),ge.push(()=>Ne(e,"unread",c)),ge.push(()=>Ne(e,"withfilesonly",m)),ge.push(()=>Ne(e,"maxtime",u)),{c(){G(e.$$.fragment)},m(b,p){H(e,b,p),a=!0},p(b,p){const h={};p[0]&1&&(h.store=b[0]),p[0]&8192&&(h.submitEnabled=b[13]),!t&&p[0]&4&&(t=!0,h.sendername=b[2],je(()=>t=!1)),!s&&p[0]&8&&(s=!0,h.recipientname=b[3],je(()=>s=!1)),!r&&p[0]&16&&(r=!0,h.unread=b[4],je(()=>r=!1)),!n&&p[0]&32&&(n=!0,h.withfilesonly=b[5],je(()=>n=!1)),!i&&p[0]&64&&(i=!0,h.maxtime=b[6],je(()=>i=!1)),e.$set(h)},i(b){a||(S(e.$$.fragment,b),a=!0)},o(b){D(e.$$.fragment,b),a=!1},d(b){l[27](null),O(e,b)}}}function Ss(l){let e,t,s;function r(i){l[33](i)}let n={store:l[0],enabled:l[8]&&!l[9]&&!!l[1].trim(),content:l[1],handleClick:l[22]};return l[12]!==void 0&&(n.loading=l[12]),e=new Tr({props:n}),ge.push(()=>Ne(e,"loading",r)),{c(){G(e.$$.fragment)},m(i,a){H(e,i,a),s=!0},p(i,a){const o={};a[0]&1&&(o.store=i[0]),a[0]&770&&(o.enabled=i[8]&&!i[9]&&!!i[1].trim()),a[0]&2&&(o.content=i[1]),!t&&a[0]&4096&&(t=!0,o.loading=i[12],je(()=>t=!1)),e.$set(o)},i(i){s||(S(e.$$.fragment,i),s=!0)},o(i){D(e.$$.fragment,i),s=!1},d(i){O(e,i)}}}function jr(l){let e,t,s,r,n,i,a,o,f,c,m,u,_,b,p,h,y;function C(N,P){return N[8]?Lr:zr}let A=C(l),M=A(l),$=(l[14]||l[13])&&Ms(l),T=l[9]&&$s(l),L=l[7].settings.incrementalsearch&&Ss(l);return{c(){e=v("form"),t=v("div"),s=v("i"),n=z(),M.c(),i=z(),a=v("div"),$&&$.c(),o=z(),f=v("button"),c=v("i"),_=z(),T&&T.c(),b=z(),L&&L.c(),d(s,"class",r="fa fa-fw "+(l[12]?"fa-spinner fa-pulse":"fa-search")),d(s,"aria-hidden","true"),d(t,"class","position-absolute h-100 d-flex justify-content-center align-items-center px-0"),ie(t,"top","0"),ie(t,"left","0"),ie(t,"width","2.5rem"),d(c,"class",m="fa fa-fw "+(l[9]?"fa-caret-up":"fa-sliders")),d(c,"aria-hidden","true"),d(f,"type","button"),d(f,"aria-expanded",l[9]),d(f,"class","btn px-0"),ie(f,"width","2.5rem"),d(f,"title",u=l[7].strings.advsearch),d(a,"class","position-absolute h-100 d-flex align-items-center"),ie(a,"top","0"),ie(a,"right","0"),d(e,"class","local-mail-search-input position-relative svelte-5mr94p")},m(N,P){k(N,e,P),g(e,t),g(t,s),g(e,n),M.m(e,null),g(e,i),g(e,a),$&&$.m(a,null),g(a,o),g(a,f),g(f,c),g(e,_),T&&T.m(e,null),g(e,b),L&&L.m(e,null),p=!0,h||(y=[K(f,"click",ke(l[18])),he(ze.call(null,e,l[17]))],h=!0)},p(N,P){(!p||P[0]&4096&&r!==(r="fa fa-fw "+(N[12]?"fa-spinner fa-pulse":"fa-search")))&&d(s,"class",r),A===(A=C(N))&&M?M.p(N,P):(M.d(1),M=A(N),M&&(M.c(),M.m(e,i))),N[14]||N[13]?$?$.p(N,P):($=Ms(N),$.c(),$.m(a,o)):$&&($.d(1),$=null),(!p||P[0]&512&&m!==(m="fa fa-fw "+(N[9]?"fa-caret-up":"fa-sliders")))&&d(c,"class",m),(!p||P[0]&512)&&d(f,"aria-expanded",N[9]),(!p||P[0]&128&&u!==(u=N[7].strings.advsearch))&&d(f,"title",u),N[9]?T?(T.p(N,P),P[0]&512&&S(T,1)):(T=$s(N),T.c(),S(T,1),T.m(e,b)):T&&(x(),D(T,1,1,()=>{T=null}),ee()),N[7].settings.incrementalsearch?L?(L.p(N,P),P[0]&128&&S(L,1)):(L=Ss(N),L.c(),S(L,1),L.m(e,null)):L&&(x(),D(L,1,1,()=>{L=null}),ee())},i(N){p||(S(T),S(L),p=!0)},o(N){D(T),D(L),p=!1},d(N){N&&w(e),M.d(),$&&$.d(),T&&T.d(),L&&L.d(),h=!1,_e(y)}}}function Br(l,e,t){let s,r,n,i,a,o,f=I,c=()=>(f(),f=ae(m,E=>t(7,o=E)),m);l.$$.on_destroy.push(()=>f());let{store:m}=e;c();let u=!o.params.search,_=!1,b,p,h="",y="",C="",A=!1,M=!1,$=0,T=!1;const L=E=>{t(1,h=(E==null?void 0:E.content)||""),t(2,y=(E==null?void 0:E.sendername)||""),t(3,C=(E==null?void 0:E.recipientname)||""),t(4,A=(E==null?void 0:E.unread)||!1),t(5,M=(E==null?void 0:E.withfilesonly)||!1),t(6,$=(E==null?void 0:E.maxtime)||0)},N=async()=>{t(8,u=!0),r&&t(9,_=!0),await Pe(),b.focus()},P=async()=>{t(8,u=!n),t(9,_=!1),L(s)},W=async()=>{_?(t(9,_=!1),await Pe(),b.focus()):(t(9,_=!0),N(),await Pe(),p.focus())},j=async()=>{t(8,u=!0),t(9,_=!1),L(),await m.navigate({...o.params,offset:0,search:void 0}),await Pe(),b.focus()},J=async()=>{await m.navigate({...o.params,messageid:void 0,offset:void 0,search:_?{content:h.trim(),sendername:y.trim(),recipientname:C.trim(),unread:A,withfilesonly:M,maxtime:$}:{content:h.trim()}}),t(9,_=!1),t(8,u=!1)},se=E=>{E.key=="Enter"&&(E.preventDefault(),i?J():j())},R=async E=>{await m.navigate(E),t(9,_=!1),t(8,u=!1)};function Y(){h=this.value,t(1,h)}function re(E){ge[E?"unshift":"push"](()=>{b=E,t(10,b)})}function oe(E){ge[E?"unshift":"push"](()=>{p=E,t(11,p)})}function Z(E){y=E,t(2,y)}function Q(E){C=E,t(3,C)}function U(E){A=E,t(4,A)}function X(E){M=E,t(5,M)}function me(E){$=E,t(6,$)}function pe(E){T=E,t(12,T)}return l.$$set=E=>{"store"in E&&c(t(0,m=E.store))},l.$$.update=()=>{l.$$.dirty[0]&128&&t(23,s=o.params.search),l.$$.dirty[0]&8388608&&L(s),l.$$.dirty[0]&8388608&&t(24,r=!!(s!=null&&s.sendername||s!=null&&s.recipientname||s!=null&&s.unread||s!=null&&s.withfilesonly||s!=null&&s.maxtime)),l.$$.dirty[0]&25165824&&t(14,n=(s==null?void 0:s.content)||r),l.$$.dirty[0]&126&&t(13,i=!!(h.trim()||y.trim()||C.trim()||A||M||$)),l.$$.dirty[0]&254&&t(15,a=[{label:"",value:h},{label:o.strings.from,value:y},{label:o.strings.to,value:C},{label:o.strings.filterbydate,value:$>0?new Date($*1e3).toLocaleDateString():""},{label:o.strings.searchbyunread,value:A},{label:o.strings.searchbyattach,value:M}].filter(({label:E,value:V})=>!!V))},[m,h,y,C,A,M,$,o,u,_,b,p,T,i,n,a,N,P,W,j,J,se,R,s,r,Y,re,oe,Z,Q,U,X,me,pe]}class Ir extends le{constructor(e){super(),ne(this,e,Br,jr,te,{store:0},null,[-1,-1])}}function Cs(l,e,t){const s=l.slice();return s[4]=e[t],s}function Ts(l){let e,t=l[1].strings.undo+"",s,r,n;function i(){return l[2](l[4])}return{c(){e=v("button"),s=B(t),d(e,"class","local-mail-toast-undo btn font-weight-bold px-2 py-0 ml-3 svelte-kxpqnp")},m(a,o){k(a,e,o),g(e,s),r||(n=K(e,"click",i),r=!0)},p(a,o){l=a,o&2&&t!==(t=l[1].strings.undo+"")&&q(s,t)},d(a){a&&w(e),r=!1,n()}}}function zs(l,e){let t,s,r,n=e[4].text+"",i,a,o,f,c,m,u,_,b,p,h=I,y,C,A,M=e[4].undo&&Ts(e);function $(){return e[3](e[4])}return{key:l,first:null,c(){t=v("div"),s=v("div"),r=v("div"),i=B(n),a=z(),M&&M.c(),o=z(),f=v("button"),c=v("i"),u=z(),d(r,"class","px-1 mr-auto"),d(c,"class","fa fa-times"),d(f,"class","btn px-2 py-0 ml-2 text-white-50"),d(f,"title",m=e[1].strings.close),d(s,"class","toast-body d-flex align-items-center p-2"),d(t,"class","toast mt-2 mb-0"),d(t,"role","alert"),d(t,"aria-live","assertive"),d(t,"aria-atomic","true"),d(t,"data-autohide","false"),this.first=t},m(T,L){k(T,t,L),g(t,s),g(s,r),g(r,i),g(s,a),M&&M.m(s,null),g(s,o),g(s,f),g(f,c),g(t,u),y=!0,C||(A=K(f,"click",$),C=!0)},p(T,L){e=T,(!y||L&2)&&n!==(n=e[4].text+"")&&q(i,n),e[4].undo?M?M.p(e,L):(M=Ts(e),M.c(),M.m(s,o)):M&&(M.d(1),M=null),(!y||L&2&&m!==(m=e[1].strings.close))&&d(f,"title",m)},r(){p=t.getBoundingClientRect()},f(){Ws(t),h(),Xs(t,p)},a(){h(),h=Ys(t,p,fl,{})},i(T){y||(Te(()=>{y&&(b&&b.end(1),_=xe(t,Ve,{y:50,delay:200}),_.start())}),y=!0)},o(T){_&&_.invalidate(),b=Js(t,Ve,{y:50,duration:400}),y=!1},d(T){T&&w(t),M&&M.d(),T&&b&&b.end(),C=!1,A()}}}function qr(l){let e,t=[],s=new Map,r,n=l[1].toasts;const i=a=>a[4];for(let a=0;a<n.length;a+=1){let o=Cs(l,n,a),f=i(o);s.set(f,t[a]=zs(f,o))}return{c(){e=v("div");for(let a=0;a<t.length;a+=1)t[a].c();d(e,"aria-live","polite"),d(e,"aria-atomic","true"),d(e,"class","local-mail-toasts position-fixed d-flex flex-column-reverse p-3 svelte-kxpqnp")},m(a,o){k(a,e,o);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null);r=!0},p(a,[o]){if(o&3){n=a[1].toasts,x();for(let f=0;f<t.length;f+=1)t[f].r();t=we(t,o,i,1,a,n,s,e,Vs,zs,null,Cs);for(let f=0;f<t.length;f+=1)t[f].a();ee()}},i(a){if(!r){for(let o=0;o<n.length;o+=1)S(t[o]);r=!0}},o(a){for(let o=0;o<t.length;o+=1)D(t[o]);r=!1},d(a){a&&w(e);for(let o=0;o<t.length;o+=1)t[o].d()}}}function Rr(l,e,t){let s,r=I,n=()=>(r(),r=ae(i,f=>t(1,s=f)),i);l.$$.on_destroy.push(()=>r());let{store:i}=e;n();const a=f=>i.undo(f),o=f=>i.hideToast(f);return l.$$set=f=>{"store"in f&&n(t(0,i=f.store))},[i,s,a,o]}class Er extends le{constructor(e){super(),ne(this,e,Rr,qr,te,{store:0})}}function Pr(l){let e,t,s,r,n;return{c(){e=v("button"),t=v("i"),d(t,"class","fa fa fa-fw fa-arrow-left"),d(e,"type","button"),d(e,"class","local-mail-back-button btn btn-secondary svelte-h5ths1"),d(e,"title",s=l[1].strings.messagelist)},m(i,a){k(i,e,a),g(e,t),r||(n=K(e,"click",l[2]),r=!0)},p(i,[a]){a&2&&s!==(s=i[1].strings.messagelist)&&d(e,"title",s)},i:I,o:I,d(i){i&&w(e),r=!1,n()}}}function Fr(l,e,t){let s,r=I,n=()=>(r(),r=ae(i,o=>t(1,s=o)),i);l.$$.on_destroy.push(()=>r());let{store:i}=e;n();const a=()=>i.navigate({...s.params,messageid:void 0,offset:Math.floor((s.messageOffset||0)/s.preferences.perpage)*s.preferences.perpage});return l.$$set=o=>{"store"in o&&n(t(0,i=o.store))},[i,s,a]}class Ur extends le{constructor(e){super(),ne(this,e,Fr,Pr,te,{store:0})}}function Ls(l){let e,t,s=l[1].strings.all+"",r,n,i,a=l[1].strings.none+"",o,f,c,m=l[1].strings.read+"",u,_,b,p=l[1].strings.unread+"",h,y,C,A=l[1].strings.starred+"",M,$,T,L=l[1].strings.unstarred+"",N,P,W;return{c(){e=v("div"),t=v("button"),r=B(s),n=z(),i=v("button"),o=B(a),f=z(),c=v("button"),u=B(m),_=z(),b=v("button"),h=B(p),y=z(),C=v("button"),M=B(A),$=z(),T=v("button"),N=B(L),d(t,"class","dropdown-item"),d(i,"class","dropdown-item"),d(c,"class","dropdown-item"),d(b,"class","dropdown-item"),d(C,"class","dropdown-item"),d(T,"class","dropdown-item"),d(e,"class","dropdown-menu show")},m(j,J){k(j,e,J),g(e,t),g(t,r),g(e,n),g(e,i),g(i,o),g(e,f),g(e,c),g(c,u),g(e,_),g(e,b),g(b,h),g(e,y),g(e,C),g(C,M),g(e,$),g(e,T),g(T,N),P||(W=[K(t,"click",l[7]),K(i,"click",l[8]),K(c,"click",l[9]),K(b,"click",l[10]),K(C,"click",l[11]),K(T,"click",l[12])],P=!0)},p(j,J){J&2&&s!==(s=j[1].strings.all+"")&&q(r,s),J&2&&a!==(a=j[1].strings.none+"")&&q(o,a),J&2&&m!==(m=j[1].strings.read+"")&&q(u,m),J&2&&p!==(p=j[1].strings.unread+"")&&q(h,p),J&2&&A!==(A=j[1].strings.starred+"")&&q(M,A),J&2&&L!==(L=j[1].strings.unstarred+"")&&q(N,L)},d(j){j&&w(e),P=!1,_e(W)}}}function Gr(l){let e,t,s,r,n,i,a,o,f=l[2]&&Ls(l);return{c(){e=v("div"),t=v("button"),s=v("i"),i=z(),f&&f.c(),d(s,"class",r="fa fa-fw "+l[3]),d(t,"class","btn btn-secondary dropdown-toggle"),d(t,"aria-expanded",l[2]),d(t,"title",n=l[1].strings.select),d(e,"class","btn-group"),d(e,"role","group")},m(c,m){k(c,e,m),g(e,t),g(t,s),g(e,i),f&&f.m(e,null),a||(o=[K(t,"click",l[5]),he(ze.call(null,e,l[4]))],a=!0)},p(c,[m]){m&8&&r!==(r="fa fa-fw "+c[3])&&d(s,"class",r),m&4&&d(t,"aria-expanded",c[2]),m&2&&n!==(n=c[1].strings.select)&&d(t,"title",n),c[2]?f?f.p(c,m):(f=Ls(c),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},i:I,o:I,d(c){c&&w(e),f&&f.d(),a=!1,_e(o)}}}function Hr(l,e,t){let s,r,n=I,i=()=>(n(),n=ae(a,C=>t(1,r=C)),a);l.$$.on_destroy.push(()=>n());let{store:a}=e;i();let o=!1;const f=()=>{t(2,o=!1)},c=()=>{t(2,o=!o)},m=C=>{f(),a.selectAll(C)},u=()=>m("all"),_=()=>m("none"),b=()=>m("read"),p=()=>m("unread"),h=()=>m("starred"),y=()=>m("unstarred");return l.$$set=C=>{"store"in C&&i(t(0,a=C.store))},l.$$.update=()=>{l.$$.dirty&2&&t(3,s=r.selectedMessages.size==0?"fa-square-o":r.selectedMessages.size<r.listMessages.length?"fa-minus-square-o":"fa-check-square-o")},[a,r,o,s,f,c,m,u,_,b,p,h,y]}class Or extends le{constructor(e){super(),ne(this,e,Hr,Gr,te,{store:0})}}function Ds(l,e,t){const s=l.slice();return s[22]=e[t],s}function Kr(l){var a;let e,t=((a=l[6])==null?void 0:a[l[3]])+"",s,r,n,i;return{c(){e=v("button"),s=B(t),d(e,"class","local-mail-course-filter-input alert-primary form-control px-5 text-left")},m(o,f){var c;k(o,e,f),g(e,s),n||(i=[he(r=Ge.call(null,e,((c=l[6])==null?void 0:c[l[3]])||"")),K(e,"click",l[12])],n=!0)},p(o,f){var c,m;f&72&&t!==(t=((c=o[6])==null?void 0:c[o[3]])+"")&&q(s,t),r&&be(r.update)&&f&72&&r.update.call(null,((m=o[6])==null?void 0:m[o[3]])||"")},d(o){o&&w(e),n=!1,_e(i)}}}function Vr(l){let e,t,s,r,n;return{c(){e=v("input"),d(e,"type","text"),d(e,"class","local-mail-course-filter-input form-control px-5 text-truncate"),d(e,"placeholder",t=l[4].strings.filterbycourse),d(e,"aria-label",s=l[4].strings.filterbycourse)},m(i,a){k(i,e,a),ve(e,l[1]),l[18](e),r||(n=[K(e,"input",l[17]),K(e,"focus",l[10]),K(e,"keyup",l[15])],r=!0)},p(i,a){a&16&&t!==(t=i[4].strings.filterbycourse)&&d(e,"placeholder",t),a&16&&s!==(s=i[4].strings.filterbycourse)&&d(e,"aria-label",s),a&2&&e.value!==i[1]&&ve(e,i[1])},d(i){i&&w(e),l[18](null),r=!1,_e(n)}}}function Wr(l){var a;let e,t=((a=l[6])==null?void 0:a[l[3]])+"",s,r,n,i;return{c(){e=v("div"),s=B(t),d(e,"class","local-mail-course-filter-input alert-secondary form-control pl-5 pr-2 text-left")},m(o,f){var c;k(o,e,f),g(e,s),n||(i=he(r=Ge.call(null,e,((c=l[6])==null?void 0:c[l[3]])||"")),n=!0)},p(o,f){var c,m;f&72&&t!==(t=((c=o[6])==null?void 0:c[o[3]])+"")&&q(s,t),r&&be(r.update)&&f&72&&r.update.call(null,((m=o[6])==null?void 0:m[o[3]])||"")},d(o){o&&w(e),n=!1,i()}}}function As(l){let e,t,s,r,n,i=l[4].strings.togglefilterresults+"",a,o,f,c;return{c(){e=v("button"),t=v("i"),r=z(),n=v("span"),a=B(i),o=B("n"),d(t,"class",s="fa fa-fw "+l[8]+" svelte-vjiai9"),d(t,"aria-hidden","true"),d(n,"class","sr-only"),d(e,"aria-expanded",l[2]),d(e,"class","btn position-absolute h-100 d-flex align-items-center px-2"),ie(e,"top","0"),ie(e,"right","0")},m(m,u){k(m,e,u),g(e,t),g(e,r),g(e,n),g(n,a),g(n,o),f||(c=K(e,"click",l[12]),f=!0)},p(m,u){u&256&&s!==(s="fa fa-fw "+m[8]+" svelte-vjiai9")&&d(t,"class",s),u&16&&i!==(i=m[4].strings.togglefilterresults+"")&&q(a,i),u&4&&d(e,"aria-expanded",m[2])},d(m){m&&w(e),f=!1,c()}}}function Ns(l){let e,t,s=l[4].strings.allcourses+"",r,n,i,a,o=[],f=new Map,c,m,u=l[9];const _=p=>p[22].id;for(let p=0;p<u.length;p+=1){let h=Ds(l,u,p),y=_(h);f.set(y,o[p]=Bs(y,h))}let b=null;return u.length||(b=js(l)),{c(){e=v("div"),t=v("button"),r=B(s),n=z(),i=v("div"),a=z();for(let p=0;p<o.length;p+=1)o[p].c();b&&b.c(),d(t,"type","button"),d(t,"class","dropdown-item text-truncate svelte-vjiai9"),d(i,"class","dropdown-divider"),d(e,"class","dropdown-menu dropdown-menu-right dropdown-menu-md-left show svelte-vjiai9")},m(p,h){k(p,e,h),g(e,t),g(t,r),g(e,n),g(e,i),g(e,a);for(let y=0;y<o.length;y+=1)o[y]&&o[y].m(e,null);b&&b.m(e,null),c||(m=K(t,"click",l[19]),c=!0)},p(p,h){h&16&&s!==(s=p[4].strings.allcourses+"")&&q(r,s),h&17040&&(u=p[9],o=we(o,h,_,1,p,u,f,e,Ye,Bs,null,Ds),!u.length&&b?b.p(p,h):u.length?b&&(b.d(1),b=null):(b=js(p),b.c(),b.m(e,null)))},d(p){p&&w(e);for(let h=0;h<o.length;h+=1)o[h].d();b&&b.d(),c=!1,m()}}}function js(l){let e,t=l[4].strings.emptycoursefilterresults+"",s,r;return{c(){e=v("div"),s=B(t),r=z(),d(e,"class","px-4 text-danger")},m(n,i){k(n,e,i),g(e,s),g(e,r)},p(n,i){i&16&&t!==(t=n[4].strings.emptycoursefilterresults+"")&&q(s,t)},d(n){n&&w(e)}}}function Bs(l,e){let t,s,r=e[7](e[22])+"",n,i,a;function o(){return e[20](e[22])}return{key:l,first:null,c(){t=v("button"),s=new Cl(!1),n=z(),s.a=n,d(t,"type","button"),d(t,"class","dropdown-item text-truncate svelte-vjiai9"),this.first=t},m(f,c){k(f,t,c),s.m(r,t),g(t,n),i||(a=K(t,"click",o),i=!0)},p(f,c){e=f,c&640&&r!==(r=e[7](e[22])+"")&&s.p(r)},d(f){f&&w(t),i=!1,a()}}}function Xr(l){let e,t,s,r,n,i,a;function o(_,b){return _[4].params.tray=="course"?Wr:_[2]||!_[6]?Vr:Kr}let f=o(l),c=f(l),m=l[4].params.tray!="course"&&As(l),u=l[2]&&Ns(l);return{c(){e=v("div"),t=v("div"),t.innerHTML='<i class="fa fa-fw fa-filter" aria-hidden="true"></i>',s=z(),c.c(),r=z(),m&&m.c(),n=z(),u&&u.c(),d(t,"class","position-absolute h-100 d-flex align-items-center px-2 flex-shrink-1"),ie(t,"top","0"),ie(t,"left","0"),d(e,"class","local-mail-course-filter position-relative d-flex ml-auto mr-0 ml-md-0 mr-md-auto svelte-vjiai9")},m(_,b){k(_,e,b),g(e,t),g(e,s),c.m(e,null),g(e,r),m&&m.m(e,null),g(e,n),u&&u.m(e,null),i||(a=he(ze.call(null,e,l[11])),i=!0)},p(_,[b]){f===(f=o(_))&&c?c.p(_,b):(c.d(1),c=f(_),c&&(c.c(),c.m(e,r))),_[4].params.tray!="course"?m?m.p(_,b):(m=As(_),m.c(),m.m(e,n)):m&&(m.d(1),m=null),_[2]?u?u.p(_,b):(u=Ns(_),u.c(),u.m(e,null)):u&&(u.d(1),u=null)},i:I,o:I,d(_){_&&w(e),c.d(),m&&m.d(),u&&u.d(),i=!1,a()}}}function Yr(l,e,t){let s,r,n,i,a,o=I,f=()=>(o(),o=ae(c,j=>t(4,a=j)),c);l.$$.on_destroy.push(()=>o());let{store:c}=e;f();let m,u="",_=!1,b,p;const h=j=>j.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&"),y=async()=>{t(2,_=!0),t(1,u=""),await Pe(),m.focus()},C=()=>{t(2,_=!1),t(1,u="")},A=async()=>{_?C():y()},M=async()=>{await c.selectCourse(),t(2,_=!1),t(1,u="")},$=async j=>{await c.selectCourse(j.id),t(2,_=!1),t(1,u="")},T=j=>{j.key=="Escape"&&(t(2,_=!1),t(1,u=""),m.blur())};function L(){u=this.value,t(1,u)}function N(j){ge[j?"unshift":"push"](()=>{m=j,t(5,m)})}const P=()=>M(),W=j=>$(j);return l.$$set=j=>{"store"in j&&f(t(0,c=j.store))},l.$$.update=()=>{l.$$.dirty&16&&t(3,p=a.settings.filterbycourse=="shortname"?"shortname":"fullname"),l.$$.dirty&16&&t(6,b=a.courses.find(j=>j.id==a.params.courseid)),l.$$.dirty&2&&t(16,s=new RegExp(h(u.trim()).replaceAll(/\s+/gu,"\\s+"),"giu")),l.$$.dirty&65560&&t(9,r=a.courses.filter(j=>j[p].match(s))),l.$$.dirty&6&&t(8,n=_?u?"fa-times":"fa-caret-up":"fa-caret-down"),l.$$.dirty&65544&&t(7,i=j=>j[p].replaceAll(s,J=>J.trim()?"<mark>"+J+"</mark>":J))},[c,u,_,p,a,m,b,i,n,r,y,C,A,M,$,T,s,L,N,P,W]}class Jr extends le{constructor(e){super(),ne(this,e,Yr,Xr,te,{store:0})}}function Qr(l){let e,t;return e=new Or({props:{store:l[0]}}),{c(){G(e.$$.fragment)},m(s,r){H(e,s,r),t=!0},p(s,r){const n={};r&1&&(n.store=s[0]),e.$set(n)},i(s){t||(S(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function Zr(l){let e,t;return e=new Ur({props:{store:l[0]}}),{c(){G(e.$$.fragment)},m(s,r){H(e,s,r),t=!0},p(s,r){const n={};r&1&&(n.store=s[0]),e.$set(n)},i(s){t||(S(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function Is(l){let e,t,s,r,n,i;const a=[ei,xr],o=[];function f(c,m){return c[1].params.tray=="trash"?0:1}return t=f(l),s=o[t]=a[t](l),n=new il({props:{store:l[0]}}),{c(){e=v("div"),s.c(),r=z(),G(n.$$.fragment),d(e,"class","btn-group"),d(e,"role","group")},m(c,m){k(c,e,m),o[t].m(e,null),g(e,r),H(n,e,null),i=!0},p(c,m){let u=t;t=f(c),t===u?o[t].p(c,m):(x(),D(o[u],1,1,()=>{o[u]=null}),ee(),s=o[t],s?s.p(c,m):(s=o[t]=a[t](c),s.c()),S(s,1),s.m(e,r));const _={};m&1&&(_.store=c[0]),n.$set(_)},i(c){i||(S(s),S(n.$$.fragment,c),i=!0)},o(c){D(s),D(n.$$.fragment,c),i=!1},d(c){c&&w(e),o[t].d(),O(n)}}}function xr(l){let e,t,s,r;return e=new rl({props:{store:l[0]}}),s=new sl({props:{store:l[0]}}),{c(){G(e.$$.fragment),t=z(),G(s.$$.fragment)},m(n,i){H(e,n,i),k(n,t,i),H(s,n,i),r=!0},p(n,i){const a={};i&1&&(a.store=n[0]),e.$set(a);const o={};i&1&&(o.store=n[0]),s.$set(o)},i(n){r||(S(e.$$.fragment,n),S(s.$$.fragment,n),r=!0)},o(n){D(e.$$.fragment,n),D(s.$$.fragment,n),r=!1},d(n){O(e,n),n&&w(t),O(s,n)}}}function ei(l){let e,t,s,r;return e=new ol({props:{store:l[0]}}),s=new ll({props:{store:l[0]}}),{c(){G(e.$$.fragment),t=z(),G(s.$$.fragment)},m(n,i){H(e,n,i),k(n,t,i),H(s,n,i),r=!0},p(n,i){const a={};i&1&&(a.store=n[0]),e.$set(a);const o={};i&1&&(o.store=n[0]),s.$set(o)},i(n){r||(S(e.$$.fragment,n),S(s.$$.fragment,n),r=!0)},o(n){D(e.$$.fragment,n),D(s.$$.fragment,n),r=!1},d(n){O(e,n),n&&w(t),O(s,n)}}}function qs(l){let e,t;return e=new Jr({props:{store:l[0]}}),{c(){G(e.$$.fragment)},m(s,r){H(e,s,r),t=!0},p(s,r){const n={};r&1&&(n.store=s[0]),e.$set(n)},i(s){t||(S(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function Rs(l){let e,t;return e=new al({props:{store:l[0]}}),{c(){G(e.$$.fragment)},m(s,r){H(e,s,r),t=!0},p(s,r){const n={};r&1&&(n.store=s[0]),e.$set(n)},i(s){t||(S(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function ti(l){let e,t,s,r,n,i=["shortname","fullname"].includes(l[1].settings.filterbycourse),a,o;const f=[Zr,Qr],c=[];function m(p,h){return p[1].message?0:1}t=m(l),s=c[t]=f[t](l);let u=l[1].viewSize>=fe.MD&&Is(l),_=i&&qs(l),b=l[1].viewSize>=fe.MD&&Rs(l);return{c(){e=v("div"),s.c(),r=z(),u&&u.c(),n=z(),_&&_.c(),a=z(),b&&b.c(),d(e,"role","toolbar"),d(e,"class","local-mail-toolbar d-flex w-100 svelte-kqp7rd")},m(p,h){k(p,e,h),c[t].m(e,null),g(e,r),u&&u.m(e,null),g(e,n),_&&_.m(e,null),g(e,a),b&&b.m(e,null),o=!0},p(p,[h]){let y=t;t=m(p),t===y?c[t].p(p,h):(x(),D(c[y],1,1,()=>{c[y]=null}),ee(),s=c[t],s?s.p(p,h):(s=c[t]=f[t](p),s.c()),S(s,1),s.m(e,r)),p[1].viewSize>=fe.MD?u?(u.p(p,h),h&2&&S(u,1)):(u=Is(p),u.c(),S(u,1),u.m(e,n)):u&&(x(),D(u,1,1,()=>{u=null}),ee()),h&2&&(i=["shortname","fullname"].includes(p[1].settings.filterbycourse)),i?_?(_.p(p,h),h&2&&S(_,1)):(_=qs(p),_.c(),S(_,1),_.m(e,a)):_&&(x(),D(_,1,1,()=>{_=null}),ee()),p[1].viewSize>=fe.MD?b?(b.p(p,h),h&2&&S(b,1)):(b=Rs(p),b.c(),S(b,1),b.m(e,null)):b&&(x(),D(b,1,1,()=>{b=null}),ee())},i(p){o||(S(s),S(u),S(_),S(b),o=!0)},o(p){D(s),D(u),D(_),D(b),o=!1},d(p){p&&w(e),c[t].d(),u&&u.d(),_&&_.d(),b&&b.d()}}}function si(l,e,t){let s,r=I,n=()=>(r(),r=ae(i,a=>t(1,s=a)),i);l.$$.on_destroy.push(()=>r());let{store:i}=e;return n(),l.$$set=a=>{"store"in a&&n(t(0,i=a.store))},[i,s]}class li extends le{constructor(e){super(),ne(this,e,si,ti,te,{store:0})}}const{window:Es}=Xe;function Ps(l){let e,t,s;return{c(){e=v("i"),t=z(),s=B(l[1]),d(e,"class","fa fa-angle-right mx-1"),d(e,"aria-hidden","true")},m(r,n){k(r,e,n),k(r,t,n),k(r,s,n)},p(r,n){n&2&&q(s,r[1])},d(r){r&&w(e),r&&w(t),r&&w(s)}}}function Fs(l){let e,t,s;return t=new Qs({props:{strings:l[2].strings,courseid:l[2].params.courseid}}),{c(){e=v("div"),G(t.$$.fragment),d(e,"class","flex-shrink-1 text-truncate d-flex")},m(r,n){k(r,e,n),H(t,e,null),s=!0},p(r,n){const i={};n&4&&(i.strings=r[2].strings),n&4&&(i.courseid=r[2].params.courseid),t.$set(i)},i(r){s||(S(t.$$.fragment,r),s=!0)},o(r){D(t.$$.fragment,r),s=!1},d(r){r&&w(e),O(t)}}}function Us(l){let e,t,s;return t=new Qs({props:{strings:l[2].strings,courseid:l[2].params.courseid}}),{c(){e=v("div"),G(t.$$.fragment),d(e,"class","local-mail-view-side-column svelte-1hrzebc")},m(r,n){k(r,e,n),H(t,e,null),s=!0},p(r,n){const i={};n&4&&(i.strings=r[2].strings),n&4&&(i.courseid=r[2].params.courseid),t.$set(i)},i(r){s||(S(t.$$.fragment,r),s=!0)},o(r){D(t.$$.fragment,r),s=!1},d(r){r&&w(e),O(t)}}}function Gs(l){let e,t,s;return t=new zl({props:{settings:l[2].settings,strings:l[2].strings,unread:l[2].unread,drafts:l[2].drafts,courses:l[2].courses,labels:l[2].labels,params:l[2].params,onClick:l[7]}}),{c(){e=v("div"),G(t.$$.fragment),d(e,"class","local-mail-view-side-column svelte-1hrzebc")},m(r,n){k(r,e,n),H(t,e,null),s=!0},p(r,n){const i={};n&4&&(i.settings=r[2].settings),n&4&&(i.strings=r[2].strings),n&4&&(i.unread=r[2].unread),n&4&&(i.drafts=r[2].drafts),n&4&&(i.courses=r[2].courses),n&4&&(i.labels=r[2].labels),n&4&&(i.params=r[2].params),n&1&&(i.onClick=r[7]),t.$set(i)},i(r){s||(S(t.$$.fragment,r),s=!0)},o(r){D(t.$$.fragment,r),s=!1},d(r){r&&w(e),O(t)}}}function ni(l){let e,t,s,r;return e=new dr({props:{store:l[0]}}),s=new pr({props:{store:l[0]}}),{c(){G(e.$$.fragment),t=z(),G(s.$$.fragment)},m(n,i){H(e,n,i),k(n,t,i),H(s,n,i),r=!0},p(n,i){const a={};i&1&&(a.store=n[0]),e.$set(a);const o={};i&1&&(o.store=n[0]),s.$set(o)},i(n){r||(S(e.$$.fragment,n),S(s.$$.fragment,n),r=!0)},o(n){D(e.$$.fragment,n),D(s.$$.fragment,n),r=!1},d(n){O(e,n),n&&w(t),O(s,n)}}}function ri(l){let e,t;return e=new mn({props:{store:l[0],message:l[2].message}}),{c(){G(e.$$.fragment)},m(s,r){H(e,s,r),t=!0},p(s,r){const n={};r&1&&(n.store=s[0]),r&4&&(n.message=s[2].message),e.$set(n)},i(s){t||(S(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function Hs(l){let e,t;return e=new Kn({props:{store:l[0]}}),{c(){G(e.$$.fragment)},m(s,r){H(e,s,r),t=!0},p(s,r){const n={};r&1&&(n.store=s[0]),e.$set(n)},i(s){t||(S(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function ii(l){let e,t,s,r,n,i=l[2].strings.pluginname+"",a,o,f,c,m,u,_,b,p,h,y,C,A,M,$,T,L,N,P,W,j,J,se,R,Y,re;document.title=e=l[4]+" - "+l[2].strings.pluginname;let oe=l[2].viewSize<fe.LG&&Ps(l);u=new Ir({props:{store:l[0]}});let Z=l[2].viewSize<fe.LG&&Fs(l),Q=l[2].viewSize>=fe.LG&&Us(l);C=new li({props:{store:l[0]}});let U=l[2].viewSize>=fe.LG&&Gs(l);const X=[ri,ni],me=[];function pe(V,ue){return V[2].message?0:1}L=pe(l),N=me[L]=X[L](l);let E=l[2].viewSize<fe.MD&&Hs(l);return j=new Er({props:{store:l[0]}}),se=new Ul({props:{store:l[0]}}),{c(){t=z(),s=v("div"),r=v("div"),n=v("h1"),a=B(i),o=z(),oe&&oe.c(),f=z(),c=v("div"),m=v("div"),G(u.$$.fragment),_=z(),Z&&Z.c(),b=z(),p=v("div"),Q&&Q.c(),h=z(),y=v("div"),G(C.$$.fragment),A=z(),M=v("div"),U&&U.c(),$=z(),T=v("div"),N.c(),P=z(),E&&E.c(),W=z(),G(j.$$.fragment),J=z(),G(se.$$.fragment),d(n,"class","h2 local-mail-view-side-column text-truncate mb-4 svelte-1hrzebc"),d(m,"class","local-mail-view-search flex-shrink-1 svelte-1hrzebc"),d(c,"class","local-mail-view-main-column d-flex mb-4 svelte-1hrzebc"),d(r,"class","row align-items-center"),d(y,"class","local-mail-view-main-column d-flex svelte-1hrzebc"),d(p,"class","row mb-3"),d(T,"class","local-mail-view-main-column svelte-1hrzebc"),d(M,"class","row mb-3"),d(s,"class","local-mail-view container-fluid py-4 svelte-1hrzebc"),F(s,"local-mail-loading",l[2].loading)},m(V,ue){k(V,t,ue),k(V,s,ue),g(s,r),g(r,n),g(n,a),g(n,o),oe&&oe.m(n,null),g(r,f),g(r,c),g(c,m),H(u,m,null),g(c,_),Z&&Z.m(c,null),g(s,b),g(s,p),Q&&Q.m(p,null),g(p,h),g(p,y),H(C,y,null),g(s,A),g(s,M),U&&U.m(M,null),g(M,$),g(M,T),me[L].m(T,null),g(s,P),E&&E.m(s,null),g(s,W),H(j,s,null),g(s,J),H(se,s,null),l[8](s),R=!0,Y||(re=[K(Es,"resize",l[5]),K(Es,"popstate",l[6])],Y=!0)},p(V,[ue]){(!R||ue&20)&&e!==(e=V[4]+" - "+V[2].strings.pluginname)&&(document.title=e),(!R||ue&4)&&i!==(i=V[2].strings.pluginname+"")&&q(a,i),V[2].viewSize<fe.LG?oe?oe.p(V,ue):(oe=Ps(V),oe.c(),oe.m(n,null)):oe&&(oe.d(1),oe=null);const Se={};ue&1&&(Se.store=V[0]),u.$set(Se),V[2].viewSize<fe.LG?Z?(Z.p(V,ue),ue&4&&S(Z,1)):(Z=Fs(V),Z.c(),S(Z,1),Z.m(c,null)):Z&&(x(),D(Z,1,1,()=>{Z=null}),ee()),V[2].viewSize>=fe.LG?Q?(Q.p(V,ue),ue&4&&S(Q,1)):(Q=Us(V),Q.c(),S(Q,1),Q.m(p,h)):Q&&(x(),D(Q,1,1,()=>{Q=null}),ee());const Le={};ue&1&&(Le.store=V[0]),C.$set(Le),V[2].viewSize>=fe.LG?U?(U.p(V,ue),ue&4&&S(U,1)):(U=Gs(V),U.c(),S(U,1),U.m(M,$)):U&&(x(),D(U,1,1,()=>{U=null}),ee());let De=L;L=pe(V),L===De?me[L].p(V,ue):(x(),D(me[De],1,1,()=>{me[De]=null}),ee(),N=me[L],N?N.p(V,ue):(N=me[L]=X[L](V),N.c()),S(N,1),N.m(T,null)),V[2].viewSize<fe.MD?E?(E.p(V,ue),ue&4&&S(E,1)):(E=Hs(V),E.c(),S(E,1),E.m(s,W)):E&&(x(),D(E,1,1,()=>{E=null}),ee());const ye={};ue&1&&(ye.store=V[0]),j.$set(ye);const de={};ue&1&&(de.store=V[0]),se.$set(de),(!R||ue&4)&&F(s,"local-mail-loading",V[2].loading)},i(V){R||(S(u.$$.fragment,V),S(Z),S(Q),S(C.$$.fragment,V),S(U),S(N),S(E),S(j.$$.fragment,V),S(se.$$.fragment,V),R=!0)},o(V){D(u.$$.fragment,V),D(Z),D(Q),D(C.$$.fragment,V),D(U),D(N),D(E),D(j.$$.fragment,V),D(se.$$.fragment,V),R=!1},d(V){V&&w(t),V&&w(s),oe&&oe.d(),O(u),Z&&Z.d(),Q&&Q.d(),O(C),U&&U.d(),me[L].d(),E&&E.d(),O(j),O(se),l[8](null),Y=!1,_e(re)}}}function ai(l,e,t){let s,r,n,i=I,a=()=>(i(),i=ae(o,p=>t(2,n=p)),o);l.$$.on_destroy.push(()=>i());let{store:o}=e;a();let f,c=0;We(()=>{o.setViewportSize(window.innerWidth)}),Tl(()=>{c!=n.navigationId&&(c=n.navigationId,f.scrollIntoView())});const m=()=>o.setViewportSize(window.innerWidth),u=()=>o.navigate(Os()),_=p=>o.navigate(p);function b(p){ge[p?"unshift":"push"](()=>{f=p,t(3,f)})}return l.$$set=p=>{"store"in p&&a(t(0,o=p.store))},l.$$.update=()=>{var p,h;l.$$.dirty&4&&t(1,s=n.params.tray=="inbox"?n.strings.inbox:n.params.tray=="starred"?n.strings.starredmail:n.params.tray=="sent"?n.strings.sentmail:n.params.tray=="drafts"?n.strings.drafts:n.params.tray=="trash"?n.strings.trash:n.params.tray=="label"?((p=n.labels.find(y=>y.id==n.params.labelid))==null?void 0:p.name)||"":n.params.tray=="course"&&((h=n.courses.find(y=>y.id==n.params.courseid))==null?void 0:h.fullname)||""),l.$$.dirty&6&&t(4,r=n.message?n.message.subject:s)},[o,s,n,f,r,m,u,_,b]}class oi extends le{constructor(e){super(),ne(this,e,ai,ii,te,{store:0})}}async function fi(){const l=document.getElementById("local-mail-view"),e=document.getElementById("local-mail-navbar"),t=window.local_mail_view_data||{},s=await Bl(t);if(l&&new oi({target:l,props:{store:s}}),e){e.innerHTML="";const r=new Ll({target:e,props:{settings:s.get().settings,strings:s.get().strings,unread:s.get().unread,drafts:s.get().drafts,courses:s.get().courses,labels:s.get().labels,onClick:n=>s.navigate(n)}});s.subscribe(n=>{r.$set({settings:n.settings,strings:n.strings,unread:n.unread,drafts:n.drafts,courses:n.courses,labels:n.labels,params:n.params,onClick:i=>s.navigate(i)})})}}fi();
